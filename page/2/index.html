<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="正在享受无法回避的痛苦">
<meta property="og:type" content="website">
<meta property="og:title" content="Sary.severus&#96;s blog">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="Sary.severus&#96;s blog">
<meta property="og:description" content="正在享受无法回避的痛苦">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="severus">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Sary.severus`s blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Sary.severus`s blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/15/%E5%85%B3%E9%97%ADDB2%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E9%87%8D%E5%90%AF%E6%9C%8D%E5%8A%A1%E5%99%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/00-00-00.JPG">
      <meta itemprop="name" content="severus">
      <meta itemprop="description" content="正在享受无法回避的痛苦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sary.severus`s blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/15/%E5%85%B3%E9%97%ADDB2%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B9%B6%E9%87%8D%E5%90%AF%E6%9C%8D%E5%8A%A1%E5%99%A8/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-15 14:28:30" itemprop="dateCreated datePublished" datetime="2021-01-15T14:28:30+08:00">2021-01-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <ol>
<li><p>关闭数据库</p>
<h1 id="确认当前用户身份为数据库管理员-db2inst1"><a href="#确认当前用户身份为数据库管理员-db2inst1" class="headerlink" title="确认当前用户身份为数据库管理员 db2inst1"></a>确认当前用户身份为数据库管理员 db2inst1</h1><h1 id="执行如下命令，清除所有与数据库建立的连接"><a href="#执行如下命令，清除所有与数据库建立的连接" class="headerlink" title="执行如下命令，清除所有与数据库建立的连接"></a>执行如下命令，清除所有与数据库建立的连接</h1><p> db2 force application all</p>
<h1 id="因为有些工具会有重连机制"><a href="#因为有些工具会有重连机制" class="headerlink" title="因为有些工具会有重连机制"></a>因为有些工具会有重连机制</h1><h1 id="在执行上一条命令后要立即执行数据库关闭命令"><a href="#在执行上一条命令后要立即执行数据库关闭命令" class="headerlink" title="在执行上一条命令后要立即执行数据库关闭命令"></a>在执行上一条命令后要立即执行数据库关闭命令</h1><h1 id="否则会出现无法停止数据库问题"><a href="#否则会出现无法停止数据库问题" class="headerlink" title="否则会出现无法停止数据库问题"></a>否则会出现无法停止数据库问题</h1><p> db2stop</p>
<h1 id="当提示successful后即数据库停止成功"><a href="#当提示successful后即数据库停止成功" class="headerlink" title="当提示successful后即数据库停止成功"></a>当提示successful后即数据库停止成功</h1></li>
<li><p>重启服务器</p>
<h1 id="确认当前用户身份为服务器管理员-root"><a href="#确认当前用户身份为服务器管理员-root" class="headerlink" title="确认当前用户身份为服务器管理员 root"></a>确认当前用户身份为服务器管理员 root</h1><h1 id="重启服务器"><a href="#重启服务器" class="headerlink" title="重启服务器"></a>重启服务器</h1><p> reboot</p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/15/%E5%AE%89%E8%A3%85JDK1.8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/00-00-00.JPG">
      <meta itemprop="name" content="severus">
      <meta itemprop="description" content="正在享受无法回避的痛苦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sary.severus`s blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/15/%E5%AE%89%E8%A3%85JDK1.8/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-15 14:28:30" itemprop="dateCreated datePublished" datetime="2021-01-15T14:28:30+08:00">2021-01-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="安装JDK1-8"><a href="#安装JDK1-8" class="headerlink" title="安装JDK1.8"></a>安装JDK1.8</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir /usr/java</span><br><span class="line">$ tar zcvf jdk-8u91-linux-x64.tar.gz -C /usr/<span class="built_in">local</span>/java</span><br><span class="line">$ vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment">#Jdk1.8</span></span><br><span class="line">JAVA_HOME=/usr/java/jdk1.8.0_91</span><br><span class="line">JRE_HOME=/usr/java/jdk1.8.0_91/jre</span><br><span class="line">CLASS_PATH=.:<span class="variable">$JAVA_HOME</span>/lib/dt.jar:<span class="variable">$JAVA_HOME</span>/lib/tools.jar:<span class="variable">$JRE_HOME</span>/lib</span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$JRE_HOME</span>/bin</span><br><span class="line"><span class="built_in">export</span> JAVA_HOME JRE_HOME CLASS_PATH PATH</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">source</span> /etc/profile</span><br><span class="line">$ java -version</span><br><span class="line">java version <span class="string">&quot;1.8.0_91&quot;</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_91-b14)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.91-b14, mixed mode)</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/15/%E5%85%B3%E4%BA%8EDB2%E6%97%A5%E5%BF%97%E6%B8%85%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/00-00-00.JPG">
      <meta itemprop="name" content="severus">
      <meta itemprop="description" content="正在享受无法回避的痛苦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sary.severus`s blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/15/%E5%85%B3%E4%BA%8EDB2%E6%97%A5%E5%BF%97%E6%B8%85%E7%90%86/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-15 14:28:30" itemprop="dateCreated datePublished" datetime="2021-01-15T14:28:30+08:00">2021-01-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="db2数据库日志清理"><a href="#db2数据库日志清理" class="headerlink" title="db2数据库日志清理"></a><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zxw-xxcsl/p/11230262.html">db2数据库日志清理</a></h1><h3 id="1、归档日志"><a href="#1、归档日志" class="headerlink" title="1、归档日志"></a>1、归档日志</h3><p>　　当db2数据库使用归档日志（通过修改参数 LOGARCHMETH1 改成是归档日志）的时候，日志数量定期不清理，将会越积越多，最后必定会磁盘爆满，访问数据库出问题。归档日志分为三种 活动日志、联机存档日志 和 脱机存档日志。</p>
<ul>
<li>活动日志:该日志包含尚未提交或回滚的事务单元的相关信息，以及已提交但尚未写入数据库文件的事务的信息。</li>
<li>联机存档日志:活动日志中所有改动对正常处理已不需要，即该日志中所记录的事务都已提交并写入数据库文件时，该活动日志转换为联机存档日志。称之为联机，是由于它们与活动日志存放在同一个目录下。</li>
<li>脱机存档日志:将联机存档日志从活动日志目录下Copy到另外的地方存档，就称为脱机存档日志。这些日志可能在数据库前滚恢复的时候仍然需要。(所谓联机归档日志，就是归档日志文件和活动日志文件同在一个目录下；而离线归档日志，则是归档日志与活动日志分开存放)</li>
</ul>
<h3 id="2、归档日志删除"><a href="#2、归档日志删除" class="headerlink" title="2、归档日志删除"></a>2、归档日志删除</h3><p>　　1、归档日志查看　　</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db2 list history archive log all for dbname</span><br></pre></td></tr></table></figure>
<p><img src="https://img2018.cnblogs.com/blog/1644752/201907/1644752-20190723101906854-285551088.png" alt="img"></p>
<p>　　2、查看备份时间戳</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db2 list history backup all for dbname</span><br></pre></td></tr></table></figure>
<p><img src="https://img2018.cnblogs.com/blog/1644752/201907/1644752-20190723102024149-1938982315.png" alt="img"></p>
<p>　　</p>
<p>3、清楚时间戳20190712001102 前所有的离线归档日志</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db2 prune history 20190712001102 with force option and delete</span><br></pre></td></tr></table></figure>
<p>　　　　注意：db2 prune history 20190712001102 会清楚指定时间戳及之前的所有条目（不只是归档信息，还包含备份的）。默认情况下，不会清楚最后一次数据库备份后的归档日志信息</p>
<p>　　4、查看备份历史，找出最近备份数据库的日志</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db2 list history backup all for dbname</span><br></pre></td></tr></table></figure>
<p><img src="https://img2018.cnblogs.com/blog/1644752/201907/1644752-20190723102536414-2108441393.png" alt="img"></p>
<p>　　5、清除S0000699.LOG之前的联机子备份日志</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db2 connect to dbname user user using pwaswd；</span><br><span class="line">db2 prune logfile prior to S0000699.LOG</span><br></pre></td></tr></table></figure>


<h3 id="3、其他说明"><a href="#3、其他说明" class="headerlink" title="3、其他说明"></a>3、其他说明</h3><p>查看当前活动日志</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">db2pd -db dbname -logs</span><br></pre></td></tr></table></figure>
<p><img src="https://img2018.cnblogs.com/blog/1644752/201907/1644752-20190723103102963-2114410931.png" alt="img"></p>
<p>prune logfile prior to XXXXXXX.LOG 除活动日志目录下的XXXXXXX.log以前的在线归档日志文件<br>db2 prune history [XXXXXXXXXXXXXX] with force option and delete 清除时间戳以前的离线归档日志文件</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/15/%E5%85%B3%E4%BA%8EDB2%E8%A1%A8%E7%A9%BA%E9%97%B4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/00-00-00.JPG">
      <meta itemprop="name" content="severus">
      <meta itemprop="description" content="正在享受无法回避的痛苦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sary.severus`s blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/15/%E5%85%B3%E4%BA%8EDB2%E8%A1%A8%E7%A9%BA%E9%97%B4/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-15 14:28:30" itemprop="dateCreated datePublished" datetime="2021-01-15T14:28:30+08:00">2021-01-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="表空间的概念"><a href="#表空间的概念" class="headerlink" title="表空间的概念"></a>表空间的概念</h2><p>数据库由称为表空间的部件组成。表空间是用来存储表的位置。当创建表时，您可以决定将特定对象（如索引和大对象）数据与其余表数据分开存放。表空间也可以分布在一个或多个物理存储设备上。</p>
<p>我们这一节主要讲讲如何创建表空间（如需要使用什么样的参数来创建最适用的表空间）</p>
<p><img src="https://s1.51cto.com/images/20180301/1519891302683389.png?x-oss-process=image/watermark,size_16,text_QDUxQ1RP5Y2a5a6i,color_FFFFFF,t_100,g_se,x_10,y_10,shadow_90,type_ZmFuZ3poZW5naGVpdGk=" alt="1.png"></p>
<h2 id="表空间类型选择"><a href="#表空间类型选择" class="headerlink" title="表空间类型选择"></a>表空间类型选择</h2><p>表空间可分为SMS表空间和DMS表空间，</p>
<p>简单来说，SMS表空间易于管理，DMS表空间性能更优。</p>
<p><strong>SMS表空间：</strong></p>
<p>1）根据需要，系统按需分配；</p>
<p>2）由于不必预定义容器，因此创建表空间需要的初始工作少。</p>
<p>3）通过操作系统来管理空间，逻辑上数据是连续的，但物理上不是。</p>
<p><strong>DMS表空间：</strong></p>
<p>1）可通过ALTER TABLESPACE来添加或扩展容器来增加表空间大小，现有数据可以在新添加的容器集合中重新平衡以保持最佳I/O效率。</p>
<p>2）可将数据分割存放在多个表空间中以提高性能和空间存储容量。</p>
<p>3）可控制数据在磁盘上的位置（需操作系统允许）</p>
<p>4）精心设计的DMS性能优于SMS表空间（涉及大量DML操作的应用程序，建议使用DMS表空间）</p>
<p>5）数据在物理磁盘上是连续的。</p>
<p>注：对于个人数据库用SMS表空间管理最容易。对于不断增长的大型数据库，建议使用SMS表空间做临时表空间和系统编目表空间，而将具有多个容器的单独的DMS表空间用于每个表。另外建议将长字段（LF）数据和索引存储在它们自己的表空间中。</p>
<h3 id="从表中数据量考虑表空间选择"><a href="#从表中数据量考虑表空间选择" class="headerlink" title="从表中数据量考虑表空间选择"></a>从表中数据量考虑表空间选择</h3><p><strong>SMS表空间：</strong></p>
<p>计划在一个表空间中存储许多小表，应考虑使用SMS表空间。（对于小标，DMS表现在I/O和空间管理效率方面优点没有那么重要）</p>
<p><strong>DMS表空间：</strong></p>
<p>表较大或者需要更快地访问表中的数据，应考虑具有较小扩展数据块大小的DMS表空间。</p>
<h3 id="从表数据类型考虑表空间"><a href="#从表数据类型考虑表空间" class="headerlink" title="从表数据类型考虑表空间"></a>从表数据类型考虑表空间</h3><p>1）有的表包含不经常使用的历史记录数据，用户可能愿意接受较长的响应时间。可以为历史记录表使用单独的表空间，并分配给访问速率较低的较便宜的物理设备。</p>
<p>2）有些表需要数据快速响应，需要将这些表分配给快速物理设备的表空间中。可以使用固态硬盘来存放访问最频繁的表。</p>
<p>3）使用DMS表空间，可以将表数据分发在3个不同的表空间中：</p>
<p>一个存储索引数据；</p>
<p>一个存储大对象（LOB）和长字段（LF）数据；</p>
<p>一个存储常规表数据。</p>
<p>（如果将表分布在各个DMS表空间中，在启用表空间级备份恢复时，应考虑一起备份和复原那些表空间。SMS表空间不支持以此方式将数据分发在所有表空间中）。</p>
<p>如果需要经常删除并重新创建特定表，应给这样的表表单独创建DMS表空间，因为删除DMS表空间比删除表更有效率。</p>
<h2 id="选择合适的数据页大小"><a href="#选择合适的数据页大小" class="headerlink" title="选择合适的数据页大小"></a>选择合适的数据页大小</h2><p>数据页可选择使用4KB、8KB、16KB、32KB页大小，在选择数据页大小时需要综合考虑空间需求和业务类型（性能需求）以做出选择。</p>
<p>DB2中每个页大小限定了可存储行的最大长度和可存储表空间的最大值，所以选择页大小的时候需要考虑这些。</p>
<p>4KB – 最大可存放的行长度是4005字节</p>
<table>
<thead>
<tr>
<th>表空间特定于页大小的限制</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td>表空间类型</td>
<td>4KB</td>
<td>8KB</td>
<td>16KB</td>
<td>32KB</td>
</tr>
<tr>
<td>SMS表空间</td>
<td>64GB</td>
<td>128GB</td>
<td>256GB</td>
<td>512GB</td>
</tr>
<tr>
<td>DMS表空间（常规）</td>
<td>64GB</td>
<td>128GB</td>
<td>256GB</td>
<td>512GB</td>
</tr>
<tr>
<td>DMS表空间（大型）</td>
<td>8TB</td>
<td>16TB</td>
<td>32TB</td>
<td>64TB</td>
</tr>
<tr>
<td>自动存储表空间（常规）</td>
<td>64GB</td>
<td>128GB</td>
<td>256GB</td>
<td>512GB</td>
</tr>
<tr>
<td>自动存储表空间（大型）</td>
<td>8TB</td>
<td>16TB</td>
<td>32TB</td>
<td>64TB</td>
</tr>
<tr>
<td>临时表空间</td>
<td>64GB</td>
<td>128GB</td>
<td>256GB</td>
<td>512GB</td>
</tr>
</tbody></table>
<p>数据页大小选择不当，可能造成空间浪费。</p>
<p>建议常见表表空间时，尽量创建大型表空间，大型表空间的数据页可以存放更多的容量和行数。</p>
<h3 id="根据业务类型选择合适的页大小（OLTP、OLAP、批处理、报表，混合类型）"><a href="#根据业务类型选择合适的页大小（OLTP、OLAP、批处理、报表，混合类型）" class="headerlink" title="根据业务类型选择合适的页大小（OLTP、OLAP、批处理、报表，混合类型）"></a>根据业务类型选择合适的页大小（OLTP、OLAP、批处理、报表，混合类型）</h3><p>联机事务处理（OLTP）工作负载的特征：事务需要对数据进行随机访问，涉及频繁插入或更新活动和返回一小组数据的查询。对于性能要求很高的OLTP应用，可以考虑把一些频繁访问的表创建在固态硬盘上。（使用裸设备容器的DMS表空间在这种情况下表现最好）</p>
<p>OLAP查询工作负载的特征：事务需要对数据进行顺序访问或部分顺序访问，并常返回大的数据集。（使用多个设备容器且每个容器都在单独磁盘上的DMS表空间最有可能提供有效的并行预存取）。应将PREFETCHSIZE参数的值设为EXTENTSIZE参数的值乘以容器设备数之积。并可以将预取大小设置为-1（AUTOMATIC），这允许数据库管理器以并行方式从所有容器中预取。如果容器数目发生更改，或需要使预取更多或更少，那么可以使用ALTER TABLESPACE语句响应地更改PREFETCHSIZE值；强烈建议把PREFETCHSIZE设置为AUTOMATIC或-1。</p>
<p>混合工作负载的目标：对于OLTP工作负载，使单个I/O请求尽可能有效率；对于OLAP查询工作负载，最大程度地提高并行I/O的效率。</p>
<h3 id="表空间页大小选择注意事项"><a href="#表空间页大小选择注意事项" class="headerlink" title="表空间页大小选择注意事项"></a>表空间页大小选择注意事项</h3><p>1） 对于执行随机行读写操作的OLTP应用程序，通常最好使用较小的页大小（4KB、8KB），这样不需要的行就不会浪费缓冲池空间；</p>
<p>2） 对于一次访问大量连续行的决策支持系统（DSS）和OLAP应用程序，页大小大点（16KB、32KB）比较好，这样能减少读取特定数目的行所需的I/O请求数。较大的页大小还允许减少索引中的层数，因为在一页中可以保留更多的行指针。</p>
<p>3） 越大的页，支持的行越长。应根据业务需求选择合适的数据页。</p>
<p>4） 4KB – 表有500列；8KB、16KB、32KB支持1012列。</p>
<p>5） 表空间最大大小与表空间的页大小成正比（参考表3-3）</p>
<h3 id="扩展数据块在进行大小选择时的注意事项"><a href="#扩展数据块在进行大小选择时的注意事项" class="headerlink" title="扩展数据块在进行大小选择时的注意事项"></a>扩展数据块在进行大小选择时的注意事项</h3><p>EXTENTSIZE指定在跳到下一个容器之前可以写入容器PAGESIZE页面的数量。存储数据时数据库管理器反复均衡使用所有容器。该参数只有在表空间中有多个容器时才起作用。合理的EXTENTSIZE会对表空间的性能产生重大影响。这个参数只能在创建表空间时定义，之后不能修改。</p>
<p>以下经验法则建立在表空间中每个表的平均大小的基础上：</p>
<p>1） 如果小于50MB，EXTENTSIZE为8</p>
<p>2） 如果介于50MB到500MB之间，EXTENTSIZE为16</p>
<p>3） 如果介于500MB到5GB之间，EXTENTSIZE为32</p>
<p>4） 如果大于5GB，EXTENTSIZE为64</p>
<p>对于OLAP数据库和大部分对表的访问包括许多查询或处理大量数据的事物（仅限于查询）的表，或者增长速度很快的表，从表中预取数据可以显著改善性能，应使用较大的extent，反之，使用较小的extent。</p>
<h3 id="Prefetchsize大小选择"><a href="#Prefetchsize大小选择" class="headerlink" title="Prefetchsize大小选择"></a>Prefetchsize大小选择</h3><p>为了提高缓冲池命中率，数据库通过预取操作再查询使用所需的数据之前读入这些数据，因为数据已经存在于内存，查询在使用这些数据的时候就不必等待执行I/O了。数据库管理器会确定预取操作是否有助于提高性能。</p>
<p>通过ALTER TABLEPSPACE可以修改预取大小。一般最优设置如下：</p>
<p>Prefetch Size = (# Containers of the table space on different physical disks) * Extent Size</p>
<p>如果表空间驻留在某个磁盘阵列上，那按如下设置：</p>
<p>Prefetch Size = Extent Size * (# of non-parity disks in array)</p>
<p>注：DB2 V9版本以后，可以在创建表空间时自动预取大小。</p>
<p>在添加或删除容器后，要及时更新表空间的预取大小，否则数据库性能会明显降低。可以在创建表空间时指定Prefetchsize 为 Automatic，这样可以设置自动预取大小。可通过以下方法查看是否设置自动预取：</p>
<p>db2 get snapshot for tablespaces on dbname| more</p>
<p>Prefetchsize的大小设置和Extentsize的设置有关，所以需要合理设置 Extentsize大小，再根据Extentsize大小设置Prefetchsize。较好的建议是创建数据库时采用自动存储，这样数据库管理器可自动设置Prefetchsize和Extentsize的大小。</p>
<h3 id="文件系统（CIO-DIO）和裸设备"><a href="#文件系统（CIO-DIO）和裸设备" class="headerlink" title="文件系统（CIO/DIO）和裸设备"></a>文件系统（CIO/DIO）和裸设备</h3><p>在创建DMS表空间容器时可以选择使用文件系统或裸设备。</p>
<p>为避免操作系统做多一次缓存（数据库已经通过buffer pool做了一次缓存），可以采用裸设备作为数据文件的存储设备。裸设备也称为裸分区（Raw Partition），是没有被加载（mount）到操作系统的文件系统中的磁盘分区，通过字符设备驱动来访问。裸设备的I/O读写不由操作系统控制，而是由应用系统（如数据库）直接控制。</p>
<p><strong>裸设备的优点：</strong></p>
<p>\1.    具有更好的性能（屏蔽了文件系统缓冲区而进行直接读写）。对硬盘的直接读写意味着取消了硬盘与文件系统的同步需求。这一点对于纯OLTP系统非常有用，因为这种系统的读写随机性非常大，以至于一旦数据被读写之后，在今后较长一段时间内不会再次使用。改善决策支持系统（DSS）应用程序的性能：</p>
<p>² 排序：DSS环境存在大量排序需求，裸设备提供的直接读写功能非常有用，因为对临时表空间的写动作速度更快。</p>
<p>² 顺序访问：裸设备非常适合顺序I/O动作。DSS中常见顺序I/O（表/索引的全表扫描）</p>
<p>\2.    直接读写，不需要经过操作系统级的缓存。</p>
<p>\3.    避免了操作系统的cache预读功能，减少了I/O。</p>
<p>\4.    避免了文件系统的开销，比如维护i-node、空闲块等。</p>
<p><strong>裸设备的缺点：</strong></p>
<p>\1.    裸设备的空间大小管理不灵活。需要预先规划裸设备的空间使用，还应当保留一部分裸设备以应付突发情况。</p>
<p>\2.    需要操作系统root用户干预，因为裸设备的创建、更改权限、扩展大小等都需要由root用户完成，这增加的了管理成本。</p>
<p><strong>文件系统的优点：</strong></p>
<p>易于管理和维护，比如文件的基本管理以及安全和备份等。</p>
<p><strong>文件系统的缺点：</strong></p>
<p>性能比不上裸设备</p>
<p>选择表空间容器时，从性能上考虑尽量采用裸设备；如果使用自动存储方式创建数据库和表空间，则不支持裸设备。或者为了便于管理而采用文件系统方式，这时需要合理设置文件系统相关选项和表空间相关选项。</p>
<p>直接I/O(DIO)可以绕过在文件系统级别进行高速缓存，因此能改进内存性能。此过程可减少CPU开销并使得更多的内存可用于数据库实例。</p>
<p>并发I/O(CIO)具有DIO的优点，并且可消除串行化写访问。与使用文件系统缓冲I/O相比，在具有大量事务处理工作负载和回滚时，CIO/DIO机制可增大吞吐量。</p>
<p>注：DIO和CIO具体的支持列表查看最新的DB2信息中心。</p>
<p>关键字 NO FILE SYSTEM CACHING 和 FILE SYSTEM CACHING是CREATE 和 ALTER TABLEPACE 语句的一部分。</p>
<p>当 NO FILE SYSTEM CACHING有效时，只要可能，数据库管理器会尝试使用“并发I/O(CIO)”。在不支持CIO时，（例如使用了JFS）将取而代之使用DIO。</p>
<p>建议在表空间级别启用或禁用操作系统中的非缓冲I/O。这将允许在特定表空间上启用或禁用非缓冲I/O，同时可避免数据库物理布局中的任何依赖性。另外还可允许数据库管理器确定每个文件最适合使用哪种I/O，缓冲的还是非缓冲的。</p>
<p>NO FILE SYSTEM CACHING子句用于启用非缓冲I/O，从而禁用特定表空间的文件高速缓存。一旦启用非缓冲I/O，数据库管理器会根据平台自动确定将使用直接I/O还是并发I/O。使用CIO可提高性能，只要CIO受支持，数据库管理器就会启用。</p>
<p>FILE SYSTEM CACHING一般用于应用程序检索LOB和LONG数据，这些大对象数据不能经过数据库缓冲池。</p>
<p>查看是否启用FILE SYSTEM CACHING属性，可使用：</p>
<p>db2 get snapshot for tablespaces on <dbname>|more</p>
<p>db2pd -d <dbname> -tablespaces</p>
<p>db2look -d <dbname> l</p>
<p>建议创建表空间时，表空间的容器采用裸设备或支持并发I/O或直接I/O的文件系统。</p>
<h3 id="设置OVERHEAD和TRANSFERRATE"><a href="#设置OVERHEAD和TRANSFERRATE" class="headerlink" title="设置OVERHEAD和TRANSFERRATE"></a>设置OVERHEAD和TRANSFERRATE</h3><p>这两个参数用于确定查询优化期间的I/O成本。这两个值的测量单位都是毫秒，而且它们是所有容器开销和传送速率的平均值。开销是与I/O控制器活动、磁盘寻道时间和旋转延迟时间相关联的时间。传送速率是将一页读入内存所必须的时间量。它们的默认值分别是24.1和0.9。可根据硬件规格计算这些值：</p>
<p>Transrate = (1/传送速率)<em>1000/1024000</em>4096（假设用4KB页大小）</p>
<p>Overhead = 平均寻道时间+（（1/磁盘转速）<em>60</em>1000）/2)</p>
<p>平均寻道时间、磁盘旋转速度和传送速率是由硬盘本身决定（可通过操作系统命令或从硬盘厂商获得底层硬盘的物理特性）</p>
<p>所以合理设置这两个值，可让优化器了解底层存储的物理特性，从而制定最优的执行计划。</p>
<h2 id="优化RAID设备上表空间的性能"><a href="#优化RAID设备上表空间的性能" class="headerlink" title="优化RAID设备上表空间的性能"></a>优化RAID设备上表空间的性能</h2><p>现在很多应用系统吧数据库存放在“独立磁盘冗余阵列”（RAID）设备上，要优化存放在RAID设备上的表空间性能，可遵循以下准则：</p>
<p>\1.    在一组RAID设备上创建表空间时，应该把表空间容器创建在多个RAID GROUP上。</p>
<p>\2.    为表空间选择适当的扩展数据块（extent）大小。理想状态下，扩展数据块大小应该等于磁盘底层strip大小或其倍数，其中strip大小等于strip大小乘以活动磁盘数。Strip大小表示磁盘控制器在向一个物理磁盘写入多少数据后才转向下一个物理磁盘。</p>
<p>如果strip大小为64KB，页大小为16KB，那适当的扩展数据块大小可能是256KB（64KB*4）</p>
<p>\3.    使用DB2_PARALLEL_IO注册变量为所有表空间启用并行I/O，并为每个容器指定物理磁盘数。</p>
<p>DB2_PARALLEL_IO注册变量用来确定每个容器的底层物理硬盘数以及对表空间上并行I/O的影响。当为表空间设置多个容器或者设置DB2_PARALLEL_IO注册变量时，会为表空间启动并行预取。如未设置DB2_PARALLEL_IO，那表空间的并行度与容器数目相等。否则，表空间的并行度由表空间预取大小和EXTENT大小决定，建议将预取大小设置为AUTOMATIC，由DB2自动计算预取大小，让DB2选择最合适的并行度。</p>
<p>DB2_PARALLEL_IO = TablespaceID:[n]，如果没有指定n，那么使用默认值6（就是假设容器跨越6个RAID底层物理磁盘）。</p>
<p>DB2_PARALLEL_IO =* （*表示所有表空间均启用并行I/O，没有指定n，所以所有表空间使用容器磁盘数目等于6的默认值。将预取请求分解成“6x容器数目”个并行请求，每个请求的读取大小为extent大小。</p>
<p>DB2_PARALLEL_IO =*:3 (*表示所有表空间均启用并行I/O，3表示所有表空间使用容器磁盘数目等于3。将预取请求分解成“3x容器数目”个并行请求，每个请求的读取大小为extent大小。)</p>
<p>DB2_PARALLEL_IO =*:3 1:1 (*表示所有表空间均启用并行I/O，3表示所有表空间使用容器磁盘数目等于3。将预取请求分解成“3x容器数目”个并行请求，每个请求的读取大小为extent大小。对于ID为1的表空间，将预取请求分解成“1x容器数目”个并行请求，每个请求的读取大小为extent大小。)</p>
<p>如果将表空间的预取大小设置为AUTOMATIC， 那么数据库管理器将使用为DB2_PARALLEL_IO 指定的物理磁盘数值来确定预取大小值。如果预取大小未设置为AUTOMATIC，可以手动设置，需考虑RAID条带大小，它是strip大小乘以活动磁盘数产生的值：</p>
<p>l 等于RAID条带大小乘以RAID并行设备数（或此乘积的整数表示）</p>
<p>l 是扩展数据块的大小的整数表示。</p>
<p>不要设置DB2_USE_PAGE_CONTAINER_TAG注册变量，如果设置为ON，将使用单页容器标记，并且扩展数据块不会与RAID条带对其。 应使用等于RAID条带大小或其倍数的扩展数据块大小来创建表空间。</p>
<h2 id="举例"><a href="#举例" class="headerlink" title="举例"></a>举例</h2><p>说了那么多建表空间的参数选择，下面我们举例子来实际操作，以下是创建表空间的完整语句：</p>
<p><strong>创建单区的表空间</strong></p>
<p>CREATE REGULAR TABLESPACE “TBS_BASS_WEB” IN DATABASE PARTITION GROUP IBMDEFAULTGROUP PAGESIZE 32768 MANAGED BY DATABASE</p>
<p>​     USING (FILE ‘/db2home/db2inst1/db2inst1/NODE0000/tbs_bass_web’655360,</p>
<p>​        FILE ‘/db2home/db2inst1/db2inst1/NODE0000/tbs_bass_web1’655360,</p>
<p>​        FILE ‘/db2data/tbs/tbs_bass_web7’655360,</p>
<p>​        FILE ‘/db2data/tbs/tbs_bass_web8’655360)</p>
<p>​     EXTENTSIZE 32</p>
<p>​     PREFETCHSIZE AUTOMATIC</p>
<p>​     BUFFERPOOL BASS_WEB</p>
<p>​     OVERHEAD 24.100000</p>
<p>​     TRANSFERRATE 0.900000</p>
<p>​     FILE SYSTEM CACHING </p>
<p>​     DROPPED TABLE RECOVERY ON;</p>
<p>​    </p>
<p>​    </p>
<p>​    </p>
<p><strong>创建多分区的表空间（指定了多个分区 “DBPARTITIONNUMS”）</strong></p>
<p>CREATE LARGE TABLESPACE “TBS_DWD” IN DATABASE PARTITION GROUP NDGRP11 PAGESIZE 32768 MANAGED BY DATABASE</p>
<p>​     USING (DEVICE ‘/dev/md/vgmt01/rdsk/d503’ 655360,</p>
<p>​         DEVICE ‘/dev/md/vgmt01/rdsk/d509’655360,</p>
<p>​         DEVICE ‘/dev/md/vgmt01/rdsk/d510’6553600) ON DBPARTITIONNUMS (1)</p>
<p>​     USING (DEVICE ‘/dev/md/vgmt02/rdsk/d503’ 655360,</p>
<p>​         DEVICE ‘/dev/md/vgmt02/rdsk/d509’655360,</p>
<p>​         DEVICE ‘/dev/md/vgmt02/rdsk/d510’6553600) ON DBPARTITIONNUMS (2)</p>
<p>​     USING (DEVICE ‘/dev/md/vgmt03/rdsk/d503’ 655360,</p>
<p>​         DEVICE ‘/dev/md/vgmt03/rdsk/d509’655360,</p>
<p>​         DEVICE ‘/dev/md/vgmt03/rdsk/d510’6553600) ON DBPARTITIONNUMS (3)</p>
<p>​     USING (DEVICE ‘/dev/md/vgmt04/rdsk/d503’ 655360,</p>
<p>​         DEVICE ‘/dev/md/vgmt04/rdsk/d509’655360,</p>
<p>​         DEVICE ‘/dev/md/vgmt04/rdsk/d510’6553600) ON DBPARTITIONNUMS (4)</p>
<p>​     EXTENTSIZE 16</p>
<p>​     PREFETCHSIZE 32</p>
<p>​     BUFFERPOOL POOL_32K</p>
<p>​     OVERHEAD 7.500000</p>
<p>​     TRANSFERRATE 0.060000</p>
<p>​     FILE SYSTEM CACHING </p>
<p>​     DROPPED TABLE RECOVERY ON;</p>
<p>如果不通过详细的参数设置，也可以使用以下简单方式，其他参数则会默认设置</p>
<p>db2 create tablespace test managed by DATABASE;</p>
<p>db2 create tablespace test managed by SYSTEM;</p>
<p>db2 create tablespace test managed by AUTOMATIC STORAGE;(自动存储，自动分配容器）</p>
<p>注：在创建DMS表空间时，表空间文件容器由DB2自动来创建，但裸设备容器无法自动创建，需要root用户参与。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>SMS和DMS表空间相比，SMS表空间特别适合一般用途。</p>
<p>SMS表空间能够提供一定的性能，且管理成本很低。</p>
<p>如果需要达到最佳的性能，则应该选用DMS表空间。</p>
<p>因为使用文件容器或者SMS表空间移动数据时会发生双重缓冲（在数据库管理程序级首先缓冲一次数据，然后在文件系统再缓冲一次数据，这就是双重缓冲），所以使用设备容器可能提供更好的性能。</p>
<p>至于如何取舍，还是要实事求是！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/15/vim%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/00-00-00.JPG">
      <meta itemprop="name" content="severus">
      <meta itemprop="description" content="正在享受无法回避的痛苦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sary.severus`s blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/15/vim%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-15 14:28:30" itemprop="dateCreated datePublished" datetime="2021-01-15T14:28:30+08:00">2021-01-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>行首 :%s/^/your_word/</p>
<p>行尾 :%s/$/your_word/</p>
<p>按键操作：</p>
<p>注释：ctrl+v 进入列编辑模式,向下或向上移动光标,把需要注释的行的开头标记起来,然后按大写的I,再插入注释符,比如”#”,再按Esc,就会全部注释了。</p>
<p>删除：先按v,进入visual模式,横向选中列的个数(如”#”注释符号,需要选中两列),再按Esc,再按ctrl+v 进入列编辑模式,向下或向上移动光标,选中注释部分,然后按d, 就会删除注释符号（#）。</p>
<p>PS：当然不一定是shell的注释符”#”，也可以是”//”，或者其他任意的字符；vim才不知道什么是注释符呢，都是字符而已。</p>
<p>使用替换命令：</p>
<p>在全部内容的行首添加//号注释</p>
<p>:% s/^////g</p>
<p>在2~50行首添加//号注释</p>
<p>:2,50 s/^////g</p>
<p>在2~50行首删除//号</p>
<p>:2,50 s/^////g</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/15/%E5%85%B3%E4%BA%8EDB2%E8%A1%A8%E5%88%86%E5%8C%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/00-00-00.JPG">
      <meta itemprop="name" content="severus">
      <meta itemprop="description" content="正在享受无法回避的痛苦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sary.severus`s blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/15/%E5%85%B3%E4%BA%8EDB2%E8%A1%A8%E5%88%86%E5%8C%BA/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-15 14:28:30" itemprop="dateCreated datePublished" datetime="2021-01-15T14:28:30+08:00">2021-01-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DB2-9表分区"><a href="#DB2-9表分区" class="headerlink" title="DB2 9表分区"></a>DB2 9表分区</h1><h2 id="开始之前"><a href="#开始之前" class="headerlink" title="开始之前"></a>开始之前</h2><p><code>CREATE TABLE</code> 语句的 PARTITION BY 子句指定了表数据的分区。该定义中使用的列被称为表分区键列。</p>
<p>关于该特性的详细说明可参见 “<a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/db2/library/techarticle/dm-0605ahuja2/">Table partitioning in DB2 9</a>”（developerWorks，2006 年 5 月）。</p>
<p>表分区特性提供以下收益：</p>
<ul>
<li>表数据可轻易实现转入和转出</li>
<li>对大型表的管理更加轻松</li>
<li>灵活的索引放置</li>
<li>更高的业务智能样式查询的性能</li>
</ul>
<h3 id="关于本教程"><a href="#关于本教程" class="headerlink" title="关于本教程"></a>关于本教程</h3><p>本教程中的练习将引领您使用表分区特性，并演示了表数据的转入转出、更轻松的大型表管理、灵活的索引放置和对业务智能样式查询的性能改善。</p>
<p>这些练习旨在演示上述各领域内的一个或多个任务。</p>
<h3 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h3><p>本教程的目标是在以下方面探究 DB2 9 范围分区的特性和优点：</p>
<ul>
<li>创建范围分区表</li>
<li>分区的转入和转出</li>
<li>分区表的管理</li>
<li>索引管理和放置</li>
</ul>
<h3 id="先决条件"><a href="#先决条件" class="headerlink" title="先决条件"></a>先决条件</h3><p>本教程的目标读者是那些技能和经验刚刚迈入中级水平的 DB2 专业人员。要学习本教程，您应该熟悉 DB2 命令行、DB2 管理工具的使用，还应具备 SQL 实践经验。</p>
<h4 id="系统需求"><a href="#系统需求" class="headerlink" title="系统需求"></a>系统需求</h4><p>要运行本教程的示例，需要具备以下条件：</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www-306.ibm.com/software/data/db2/express/download.html">DB2 9 Data Server</a></li>
<li>Microsoft® Windows® 2000 或更高版本，以及一个具有管理员权限的帐户，或具有根访问权限的 Linux®（<a target="_blank" rel="noopener" href="http://www-306.ibm.com/software/data/db2/linux/validate/">验证版</a>）。</li>
<li>确保系统中的 Java Runtime Environment 是 1.4.2 或更高版本。</li>
<li>参考 DB2 9 <a target="_blank" rel="noopener" href="http://www-306.ibm.com/software/data/db2/9/sysreqs.html">系统需求页面</a> 确保您的硬件符合要求。</li>
</ul>
<p>可通过上面的链接获取 DB2 9 Express C。关于安装 DB2 的步骤请参考 “<a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/cn/views/db2/tutorials.jsp?cv_doc_id=110099">DB2 XML 评估指南</a>”（developerWorks，2006 年 6 月）。若未改动 DB2 的配置，安装后 DB2 将自动启动。</p>
<p>使用 partition.zip 文件提供的示例脚本和数据演示本教程的概念。将其内容解压缩到 scripts 子目录（C:\scripts 或 home/userid/scripts）。本教程中将该目录简称为 stmm_scripts。教程假设您使用的是 DB2 默认安装目录，并且所有的 DB2 练习都通过一个数据库管理员 ID 执行。</p>
<h2 id="创建分区表"><a href="#创建分区表" class="headerlink" title="创建分区表"></a>创建分区表</h2><p>这个实验将探讨创建分区表、将数据载入分区表以及使用 <code>describe</code> 命令来说明表范围的方法：</p>
<ol>
<li>您将登录并为所有的练习设置基本环境。</li>
<li>您将创建不同格式的分区表并加载数据。</li>
<li>您将使用 DB2 命令和 SQL 查看结果。</li>
<li>将对 DB2 9 表范围分区进行概述。</li>
</ol>
<h4 id="登录和基本指令"><a href="#登录和基本指令" class="headerlink" title="登录和基本指令"></a>登录和基本指令</h4><h5 id="图-1-基本设置"><a href="#图-1-基本设置" class="headerlink" title="图 1. 基本设置"></a>图 1. 基本设置</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3M1LmpwZw?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p>登录到您的机器，如图 1 所示，使用 db2inst1。</p>
</li>
<li><p>打开终端窗口（Linux）或 DB2 命令窗口（windows）。</p>
</li>
<li><p>切换到 scripts 子目录。</p>
<h5 id="清单-1-切换目录"><a href="#清单-1-切换目录" class="headerlink" title="清单 1. 切换目录"></a>清单 1. 切换目录</h5><p> <code>cd c:\scripts</code></p>
</li>
<li><p>使用<code>db2start</code> 命令启动 DB2，并连接到 SAMPLE 数据库。</p>
<h5 id="清单-2-StartDB2"><a href="#清单-2-StartDB2" class="headerlink" title="清单 2. StartDB2"></a>清单 2. StartDB2</h5> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db2start</span><br><span class="line">db2 connect to SAMPLE</span><br><span class="line">12</span><br></pre></td></tr></table></figure>
<h4 id="创建基本分区表"><a href="#创建基本分区表" class="headerlink" title="创建基本分区表"></a>创建基本分区表</h4></li>
</ol>
<p>这一节将介绍分区表的基本创建和加载。您将创建不同格式的表、验证创建结果、加载数据并对表进行查询。</p>
<ol>
<li>使用如下的数据定义语言（DDL）创建具有四个范围的 LINEITEM 表：</li>
</ol>
<p>清单 3. 创建表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> LINEITEM </span><br><span class="line">( l_orderkey         <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  l_partkey          <span class="type">INTEGER</span>,</span><br><span class="line">  l_suppkey          <span class="type">INTEGER</span>,</span><br><span class="line">  l_linenumber       <span class="type">INTEGER</span>,</span><br><span class="line">  l_quantity         <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_extendedprice    <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_discount         <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_tax              <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_returnflag       <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">  l_linestatus       <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">  l_shipdate         <span class="type">DATE</span>,</span><br><span class="line">  l_commitdate       <span class="type">DATE</span>,</span><br><span class="line">  l_receiptdate      <span class="type">DATE</span>,</span><br><span class="line">  l_shipinstruct     <span class="type">CHAR</span>(<span class="number">25</span>),</span><br><span class="line">  l_shipmode         <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">  l_comment          <span class="type">VARCHAR</span>(<span class="number">44</span>))</span><br><span class="line">  <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(l_shipdate)</span><br><span class="line">( STARTING <span class="string">&#x27;1/1/1992&#x27;</span> ENDING <span class="string">&#x27;30/06/1992&#x27;</span>,</span><br><span class="line">  STARTING <span class="string">&#x27;1/7/1992&#x27;</span> ENDING <span class="string">&#x27;31/12/1992&#x27;</span>,</span><br><span class="line">  STARTING <span class="string">&#x27;1/1/1993&#x27;</span> ENDING <span class="string">&#x27;30/6/1993&#x27;</span>,</span><br><span class="line">  STARTING <span class="string">&#x27;1/7/1993&#x27;</span> ENDING <span class="string">&#x27;31/12/1993&#x27;</span>)</span><br><span class="line"><span class="number">12345678910111213141516171819202122</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>创建该表的 SQL 语句位于 EX1-6.sql 文件中，可使用如下命令运行该文件：</p>
<h5 id="清单-4-运行-EX1-6"><a href="#清单-4-运行-EX1-6" class="headerlink" title="清单 4. 运行 EX1-6"></a>清单 4. 运行 EX1-6</h5><p> <code>db2 –vtf EX1-6.sql</code></p>
</li>
<li><p>使用下面的命令说明为 LINEITEM 表创建的分区的范围：</p>
<h5 id="清单-5-说明"><a href="#清单-5-说明" class="headerlink" title="清单 5. 说明"></a>清单 5. 说明</h5><p> <code>db2 describe data partitions for table LINEITEM</code></p>
<h5 id="图-2-说明为-LINEITEM-表创建的分区范围"><a href="#图-2-说明为-LINEITEM-表创建的分区范围" class="headerlink" title="图 2. 说明为 LINEITEM 表创建的分区范围"></a>图 2. 说明为 LINEITEM 表创建的分区范围</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3M2LmpwZw?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：创建了四个数据分区。其中的范围包括边界值。</p>
</li>
<li><p>将数据导入到 LINEITEM 表。该操作的导入命令位于 EX1-8.sql 文件中，可使用如下命令运行：</p>
<h5 id="清单-6-带有拒绝的加载"><a href="#清单-6-带有拒绝的加载" class="headerlink" title="清单 6. 带有拒绝的加载"></a>清单 6. 带有拒绝的加载</h5><p> <code>db2 –vtf EX1-8.sql</code></p>
<h5 id="图-3-将数据导入到-LINEITEM-表"><a href="#图-3-将数据导入到-LINEITEM-表" class="headerlink" title="图 3. 将数据导入到 LINEITEM 表"></a>图 3. 将数据导入到 LINEITEM 表</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3M3LmpwZw?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：导入时拒绝了 729 行数据，这是因为它们不具有位于当前 LINEITEM 表的数据分区定义范围内的 l_shipdate。</p>
</li>
<li><p>标量函数可用于显示行所属的数据分区号（datapartitionnum）。执行以下示例 SQL 查看标量函数的输出：</p>
<h5 id="清单-7-查询-匹配日期的分区"><a href="#清单-7-查询-匹配日期的分区" class="headerlink" title="清单 7. 查询 - 匹配日期的分区"></a>清单 7. 查询 - 匹配日期的分区</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db2 “<span class="keyword">select</span> datapartitionnum(l_shipdate) <span class="keyword">as</span> PartitionId, l_shipdate <span class="keyword">from</span> lineitem </span><br><span class="line">        <span class="keyword">where</span> l_shipdate <span class="keyword">between</span> ’<span class="number">01</span><span class="operator">/</span><span class="number">06</span><span class="operator">/</span><span class="number">1992</span>’ <span class="keyword">and</span> ‘<span class="number">31</span><span class="operator">/</span><span class="number">07</span><span class="operator">/</span><span class="number">1992</span>’ </span><br><span class="line">        <span class="keyword">order</span> <span class="keyword">by</span> l_shipdate”</span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure>
<h5 id="图-4-标量函数的输出"><a href="#图-4-标量函数的输出" class="headerlink" title="图 4. 标量函数的输出"></a>图 4. 标量函数的输出</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3M4LmpwZw?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><strong>注意</strong>：标量函数（datapartitionnum）返回的值和 <code>describe</code> 命令返回的是同一个 PartitionId。该语句的子句间使用的谓词范围超出了 PartitionId 0 和 PartitionId 1 的边界</li>
</ol>
<h4 id="具有全部范围的分区表"><a href="#具有全部范围的分区表" class="headerlink" title="具有全部范围的分区表"></a>具有全部范围的分区表</h4><ol>
<li><p>创建具有两个额外数据分区的新 LINEITEM 表，其中一个分区用来捕获低于当前范围的值，另一个分区用来捕获高于当前范围的值。首先使用下面的命令删除现有的 LINEITEM 分区表：</p>
<h5 id="清单-8-删除表"><a href="#清单-8-删除表" class="headerlink" title="清单 8. 删除表"></a>清单 8. 删除表</h5><p> <code>db2 drop TABLE LINEITEM</code></p>
</li>
</ol>
<p>然后使用如下 DDL 创建 LINEITEM 表的新版本：</p>
<h5 id="清单-9-创建表"><a href="#清单-9-创建表" class="headerlink" title="清单 9. 创建表"></a>清单 9. 创建表</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> LINEITEM </span><br><span class="line">( l_orderkey         <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  l_partkey          <span class="type">INTEGER</span>,</span><br><span class="line">  l_suppkey          <span class="type">INTEGER</span>,</span><br><span class="line">  l_linenumber       <span class="type">INTEGER</span>,</span><br><span class="line">  l_quantity         <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_extendedprice    <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_discount         <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_tax              <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_returnflag       <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">  l_linestatus       <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">  l_shipdate         <span class="type">DATE</span>,</span><br><span class="line">  l_commitdate       <span class="type">DATE</span>,</span><br><span class="line">  l_receiptdate      <span class="type">DATE</span>,</span><br><span class="line">  l_shipinstruct     <span class="type">CHAR</span>(<span class="number">25</span>),</span><br><span class="line">  l_shipmode         <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">  l_comment          <span class="type">VARCHAR</span>(<span class="number">44</span>))</span><br><span class="line">  <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(l_shipdate)</span><br><span class="line">( STARTING MINVALUE,</span><br><span class="line">  STARTING <span class="string">&#x27;1/1/1992&#x27;</span> ENDING <span class="string">&#x27;30/06/1992&#x27;</span>,</span><br><span class="line">  STARTING <span class="string">&#x27;1/7/1992&#x27;</span> ENDING <span class="string">&#x27;31/12/1992&#x27;</span>,</span><br><span class="line">  STARTING <span class="string">&#x27;1/1/1993&#x27;</span> ENDING <span class="string">&#x27;30/6/1993&#x27;</span>,</span><br><span class="line">  STARTING <span class="string">&#x27;1/7/1993&#x27;</span> ENDING <span class="string">&#x27;31/12/1993&#x27;</span>,</span><br><span class="line">  ENDING MAXVALUE)</span><br><span class="line"><span class="number">123456789101112131415161718192021222324</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>创建该表的 SQL 位于 EX1-10.sql 文件中，可使用下列命令运行：</p>
<h5 id="清单-10-运行-EX1-10"><a href="#清单-10-运行-EX1-10" class="headerlink" title="清单 10. 运行 EX1-10"></a>清单 10. 运行 EX1-10</h5><p> <code>db2 –vtf EX1-10.sql</code></p>
</li>
<li><p>使用下面的命令说明为 LINEITEM 表创建的分区范围。</p>
<h5 id="清单-11-说明"><a href="#清单-11-说明" class="headerlink" title="清单 11. 说明"></a>清单 11. 说明</h5><p> <code>db2 describe data partitions for table LINEITEM</code></p>
<h5 id="图-5-说明为-LINEITEM-表创建的分区范围"><a href="#图-5-说明为-LINEITEM-表创建的分区范围" class="headerlink" title="图 5. 说明为 LINEITEM 表创建的分区范围"></a>图 5. 说明为 LINEITEM 表创建的分区范围</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MxMGEuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：新的 MINVALUE 范围具有一个最高值，该值和下一个数据分区开始部分的值相等，但它并不包含该值。MAXVALUE 范围具有一个最低值，该值和前一个范围结束部分的值相等，但它不包含该值。这将创建一个无间隙的连续范围。</p>
</li>
<li><p>将数据导入到 LINEITEM 表中。该操作的导入命令位于 EX1-8.sql 文件中，可使用下面的命令运行该文件：</p>
<h5 id="清单-12-全面加载"><a href="#清单-12-全面加载" class="headerlink" title="清单 12. 全面加载"></a>清单 12. 全面加载</h5><p> <code>db2 –vtf EX1-8.sql</code></p>
<h5 id="图-6-将数据导入到-LINEITEM-表中"><a href="#图-6-将数据导入到-LINEITEM-表中" class="headerlink" title="图 6. 将数据导入到 LINEITEM 表中"></a>图 6. 将数据导入到 LINEITEM 表中</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MxMGIuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<h4 id="具有生成范围的分区表"><a href="#具有生成范围的分区表" class="headerlink" title="具有生成范围的分区表"></a>具有生成范围的分区表</h4><ol>
<li><p>创建一个新 LINEITEM 表，它具有从 1992 年 1 月 1 日到 1998 年 12 月 31 日按月划分的数据分区生成范围。同样，添加 minvalue 和 maxvalue 范围来存放具有超过此范围的 l_shipdate 的值的行。首先使用以下命令删除现有的 LINEITEM 分区表：</p>
<h5 id="清单-13-删除表"><a href="#清单-13-删除表" class="headerlink" title="清单 13. 删除表"></a>清单 13. 删除表</h5><p> <code>db2 drop TABLE LINEITEM</code></p>
<p> 然后使用如下 DDL 创建 LINEITEM 表的新版本：</p>
<h5 id="清单-14-创建表"><a href="#清单-14-创建表" class="headerlink" title="清单 14. 创建表"></a>清单 14. 创建表</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> lineitem</span><br><span class="line">(l_orderkey            <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  l_cpartkey      <span class="type">INTEGER</span>,</span><br><span class="line">  l_suppkey       <span class="type">INTEGER</span>,</span><br><span class="line">  l_linenumber    <span class="type">INTEGER</span>,</span><br><span class="line">  l_quantity      <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_extendedprice <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_discount      <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_tax           <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_returnflag    <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">  l_linestatus    <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">  l_shipdate      <span class="type">DATE</span>,</span><br><span class="line">  l_commitdate    <span class="type">DATE</span>,</span><br><span class="line">  l_receiptdate   <span class="type">DATE</span>,</span><br><span class="line">  l_shipinstruct  <span class="type">CHAR</span>(<span class="number">25</span>),</span><br><span class="line">  l_shipmode      <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">  l_comment       <span class="type">VARCHAR</span>(<span class="number">44</span>))</span><br><span class="line">  <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(l_shipdate)</span><br><span class="line"> (STARTING MINVALUE,</span><br><span class="line"> STARTING <span class="string">&#x27;1/1/1992&#x27;</span> ENDING <span class="string">&#x27;31/12/1998&#x27;</span> </span><br><span class="line">                <span class="keyword">EVERY</span> <span class="number">1</span> <span class="keyword">MONTH</span>,</span><br><span class="line"> ENDING MAXVALUE);</span><br><span class="line"><span class="number">12345678910111213141516171819202122</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>创建该表的 SQL 位于 EX1-13.sql 文件中，可使用下面的命令运行该文件：</p>
<h5 id="清单-15-运行-EX1-13"><a href="#清单-15-运行-EX1-13" class="headerlink" title="清单 15. 运行 EX1-13"></a>清单 15. 运行 EX1-13</h5><p> <code>db2 –vtf EX1-13.sql</code></p>
</li>
<li><p>使用如下命令来说明为 LINEITEM 表创建的分区范围：</p>
<h5 id="清单-16-说明"><a href="#清单-16-说明" class="headerlink" title="清单 16. 说明"></a>清单 16. 说明</h5><p> <code>db2 describe data partitions for table LINEITEM</code></p>
<h5 id="图-7-说明为-LINEITEM-表创建的分区范围"><a href="#图-7-说明为-LINEITEM-表创建的分区范围" class="headerlink" title="图 7. 说明为 LINEITEM 表创建的分区范围"></a>图 7. 说明为 LINEITEM 表创建的分区范围</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MxMmEuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：创建了 86 个数据分区，但是没有包括这些范围的最高值，因为这些最高值将和之后的数据分区的最低值重叠。</p>
</li>
<li><p>将数据导入到 LINEITEM 表。此操作的导入命令位于 EX1-8.sql 文件中，可使用下面的命令运行该文件：</p>
<h5 id="清单-17-加载并生成"><a href="#清单-17-加载并生成" class="headerlink" title="清单 17. 加载并生成"></a>清单 17. 加载并生成</h5><p> <code>db2 –vtf EX1-8.sql</code></p>
<h5 id="图-8-将数据导入到-LINEITEM-表"><a href="#图-8-将数据导入到-LINEITEM-表" class="headerlink" title="图 8. 将数据导入到 LINEITEM 表"></a>图 8. 将数据导入到 LINEITEM 表</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MxMmIuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<p>使用下面的 SQL 来验证 LINEITEM 表每一个数据分区的行数：</p>
<h5 id="清单-18-查询数据"><a href="#清单-18-查询数据" class="headerlink" title="清单 18. 查询数据"></a>清单 18. 查询数据</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">db2 “<span class="keyword">select</span> <span class="keyword">year</span>(l_shipdate) <span class="keyword">as</span> <span class="keyword">year</span>, <span class="keyword">month</span>(l_shipdate) <span class="keyword">as</span> <span class="keyword">month</span>, </span><br><span class="line"><span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">as</span> count <span class="keyword">from</span> lineitem</span><br><span class="line">  <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">year</span>(l_shipdate), <span class="keyword">month</span>(l_shipdate)</span><br><span class="line">  <span class="keyword">order</span> <span class="keyword">by</span> <span class="number">1</span>, <span class="number">2</span>”</span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>
<p>使用以下的 SQL 语句验证 LINEITEM 表的每一个数据分区的行数：</p>
<h5 id="清单-19-查询数据脚本"><a href="#清单-19-查询数据脚本" class="headerlink" title="清单 19. 查询数据脚本"></a>清单 19. 查询数据脚本</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db2 –vtf EX1-16.sql</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h5 id="图-9-检验行数"><a href="#图-9-检验行数" class="headerlink" title="图 9. 检验行数"></a>图 9. 检验行数</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MxMy5qcGc?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><strong>注意</strong>：执行加载操作后，86 个范围中有 82 个范围包含一个或多个行。</li>
</ol>
<h2 id="放置分区表"><a href="#放置分区表" class="headerlink" title="放置分区表"></a>放置分区表</h2><p>该实验探讨放置分区表以及使用 <code>describe</code> 命令说明表内的范围和放置情况的方法：</p>
<ol>
<li>您将为数据放置练习创建新的表空间。</li>
<li>你将创建不同格式的分区表。</li>
<li>您将使用 db2 命令和 SQL 查看结果。</li>
</ol>
<h4 id="基本环境设置"><a href="#基本环境设置" class="headerlink" title="基本环境设置"></a>基本环境设置</h4><ol>
<li><p>使用</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">describe data partitions</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p> 命令以及</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">show detail</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p> 方法来显示表空间的分区放置。</p>
<h5 id="清单-20-创建表"><a href="#清单-20-创建表" class="headerlink" title="清单 20. 创建表"></a>清单 20. 创建表</h5><p> <code>db2 describe data partitions for table LINEITEM show detail</code></p>
<h5 id="图-10-表空间的分区放置"><a href="#图-10-表空间的分区放置" class="headerlink" title="图 10. 表空间的分区放置"></a>图 10. 表空间的分区放置</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MxNC5qcGc?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：TableSpID 列给出了包含分区的表空间的 ID 号。在本例中，TableSpID 是 ‘3’。</p>
</li>
<li><p>使用</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">list tablespaces</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p> 命令标识与 TableSpId 相关联的表空间。</p>
<h5 id="清单-21-说明"><a href="#清单-21-说明" class="headerlink" title="清单 21. 说明"></a>清单 21. 说明</h5><p> <code>db2 list tablespaces</code></p>
<h5 id="图-11-标识表空间"><a href="#图-11-标识表空间" class="headerlink" title="图 11. 标识表空间"></a>图 11. 标识表空间</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MxNS5qcGc?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：相应值为 ‘2’ 的 TableSpID 是 USERSPACE1 或默认的表空间。</p>
</li>
<li><p>现在将创建五个表空间来说明不同的放置选项。使用如下命令：</p>
<h5 id="清单-22-说明"><a href="#清单-22-说明" class="headerlink" title="清单 22. 说明"></a>清单 22. 说明</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">db2 <span class="keyword">create</span> <span class="keyword">table</span>space dms_d1 managed <span class="keyword">by</span> database <span class="keyword">using</span> (file <span class="string">&#x27;c:\ts1&#x27;</span> <span class="number">10000</span>);</span><br><span class="line">db2 <span class="keyword">create</span> <span class="keyword">table</span>space dms_d2 managed <span class="keyword">by</span> database <span class="keyword">using</span> (file <span class="string">&#x27;c:\ts2&#x27;</span> <span class="number">10000</span>);</span><br><span class="line">db2 <span class="keyword">create</span> <span class="keyword">table</span>space dms_d3 managed <span class="keyword">by</span> database <span class="keyword">using</span> (file <span class="string">&#x27;c:\ts3&#x27;</span> <span class="number">10000</span>);</span><br><span class="line">db2 <span class="keyword">create</span> <span class="keyword">table</span>space dms_d4 managed <span class="keyword">by</span> database <span class="keyword">using</span> (file <span class="string">&#x27;c:\ts4&#x27;</span> <span class="number">10000</span>);</span><br><span class="line">db2 <span class="keyword">create</span> <span class="keyword">table</span>space dms_i1 managed <span class="keyword">by</span> database <span class="keyword">using</span> (file <span class="string">&#x27;c:\ts5&#x27;</span> <span class="number">10000</span>);</span><br><span class="line"><span class="number">12345</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>创建该表空间的 SQL 位于 EX2-3.sql 文件中，可使用下面的命令运行该文件：</p>
<h5 id="清单-23-查询数据脚本"><a href="#清单-23-查询数据脚本" class="headerlink" title="清单 23. 查询数据脚本"></a>清单 23. 查询数据脚本</h5><p> <code>db2 –vtf EX2-3.sql</code></p>
</li>
<li><p>创建一个新的 LINEITEM 表，具有位于 dms_d1 和 dms_d2 表空间的生成分区集。首先，使用如下命令删除现有的 LINEITEM 分区表：</p>
<h5 id="清单-24-删除表"><a href="#清单-24-删除表" class="headerlink" title="清单 24. 删除表"></a>清单 24. 删除表</h5><p> <code>db2 drop TABLE LINEITEM</code></p>
<p> 然后，使用下面的 DDL 创建 LINEITEM 表的新版本：</p>
<h5 id="清单-25-创建表"><a href="#清单-25-创建表" class="headerlink" title="清单 25. 创建表"></a>清单 25. 创建表</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> LINEITEM</span><br><span class="line">(l_orderkey      <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> l_partkey       <span class="type">INTEGER</span>,</span><br><span class="line"> l_suppkey       <span class="type">INTEGER</span>,</span><br><span class="line"> l_linenumber    <span class="type">INTEGER</span>,</span><br><span class="line"> l_quantity      <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line"> l_extendedprice <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line"> l_discount      <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line"> l_tax           <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line"> l_returnflag    <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line"> l_linestatus    <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line"> l_shipdate      <span class="type">DATE</span>,</span><br><span class="line"> l_commitdate    <span class="type">DATE</span>,</span><br><span class="line"> l_receiptdate   <span class="type">DATE</span>,</span><br><span class="line"> l_shipinstruct  <span class="type">CHAR</span>(<span class="number">25</span>),</span><br><span class="line"> l_shipmode      <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line"> l_comment       <span class="type">VARCHAR</span>(<span class="number">44</span>))</span><br><span class="line"> <span class="keyword">IN</span> DMS_D1, DMS_D2</span><br><span class="line"> <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(l_shipdate)</span><br><span class="line">(STARTING MINVALUE,</span><br><span class="line"> STARTING <span class="string">&#x27;1/1/1992&#x27;</span> </span><br><span class="line">      ENDING <span class="string">&#x27;31/12/1998&#x27;</span> <span class="keyword">EVERY</span> <span class="number">1</span> <span class="keyword">MONTH</span>,</span><br><span class="line"> ENDING MAXVALUE);</span><br><span class="line"><span class="number">1234567891011121314151617181920212223</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>创建该表的 SQL 位于 EX2-4.sql 文件中，可使用下面的命令运行该文件：</p>
<h5 id="清单-26-运行-EX2-4"><a href="#清单-26-运行-EX2-4" class="headerlink" title="清单 26. 运行 EX2-4"></a>清单 26. 运行 EX2-4</h5><p> <code>db2 –vtf EX2-4.sql</code></p>
</li>
<li><p>使用下面的命令说明为 LINEITEM 表创建的分区范围：</p>
<h5 id="清单-27-说明"><a href="#清单-27-说明" class="headerlink" title="清单 27. 说明"></a>清单 27. 说明</h5><p> <code>db2 describe data partitions for table LINEITEM show detail</code></p>
<h5 id="图-12-说明为-LINEITEM-表创建的分区范围"><a href="#图-12-说明为-LINEITEM-表创建的分区范围" class="headerlink" title="图 12. 说明为 LINEITEM 表创建的分区范围"></a>图 12. 说明为 LINEITEM 表创建的分区范围</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MxN2EuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<h5 id="图-13-分区"><a href="#图-13-分区" class="headerlink" title="图 13. 分区"></a>图 13. 分区</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MxN2IuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><strong>注意</strong>：TableSpID 列给出了包含分区的表空间的 ID 号。在本例中，TableSpID 为 4（对应于 DMS_D1）或 5（对应于 DMS_D2）。本例中将生成的分区依次分配给指定的表空间。</li>
</ol>
<h4 id="分区的显式放置"><a href="#分区的显式放置" class="headerlink" title="分区的显式放置"></a>分区的显式放置</h4><ol>
<li><p>创建一个具有四个数据分区的新 LINEITEM 表，每一个数据分区被显式地放在表空间中。首先使用如下命令删除现有的 LINEITEM 表：</p>
<h5 id="清单-28-删除表"><a href="#清单-28-删除表" class="headerlink" title="清单 28. 删除表"></a>清单 28. 删除表</h5><p> <code>db2 drop TABLE LINEITEM</code></p>
<p> 然后使用下面的 DDL 创建 LINEITEM 表的新版本：</p>
<h5 id="清单-29-创建表"><a href="#清单-29-创建表" class="headerlink" title="清单 29. 创建表"></a>清单 29. 创建表</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> LINEITEM</span><br><span class="line"> (l_orderkey          <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  l_partkey           <span class="type">INTEGER</span>,</span><br><span class="line">  l_suppkey           <span class="type">INTEGER</span>,</span><br><span class="line">  l_linenumber        <span class="type">INTEGER</span>,</span><br><span class="line">  l_quantity          <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_extendedprice     <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_discount          <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_tax               <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line">  l_returnflag        <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">  l_linestatus        <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">  l_shipdate          <span class="type">DATE</span>,</span><br><span class="line">  l_commitdate        <span class="type">DATE</span>,</span><br><span class="line">  l_receiptdate       <span class="type">DATE</span>,</span><br><span class="line">  l_shipinstruct      <span class="type">CHAR</span>(<span class="number">25</span>),</span><br><span class="line">  l_shipmode          <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line">  l_comment           <span class="type">VARCHAR</span>(<span class="number">44</span>))</span><br><span class="line"> <span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(l_shipdate)</span><br><span class="line"> ( STARTING MINVALUE <span class="keyword">IN</span> DMS_D1,</span><br><span class="line">   STARTING <span class="string">&#x27;1/1/1992&#x27;</span> ENDING <span class="string">&#x27;31/12/1992&#x27;</span> <span class="keyword">IN</span> DMS_D2,</span><br><span class="line">   STARTING <span class="string">&#x27;1/1/1993&#x27;</span> ENDING <span class="string">&#x27;31/12/1993&#x27;</span> <span class="keyword">IN</span> DMS_D3,</span><br><span class="line">   ENDING MAXVALUE <span class="keyword">IN</span> DMS_D4 );</span><br><span class="line"><span class="number">12345678910111213141516171819202122</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>创建表的 SQL 位于 EX2-6.sql 文件中，可使用下面的命令运行该文件：</p>
<h5 id="清单-30-运行-EX2-6"><a href="#清单-30-运行-EX2-6" class="headerlink" title="清单 30. 运行 EX2-6"></a>清单 30. 运行 EX2-6</h5><p> <code>db2 –vtf EX2-6.sql</code></p>
</li>
<li><p>使用下面的命令说明为 LINEITEM 表创建的分区范围：</p>
<h5 id="清单-31-说明"><a href="#清单-31-说明" class="headerlink" title="清单 31. 说明"></a>清单 31. 说明</h5><p> <code>db2 describe data partitions for table LINEITEM show detail</code></p>
<h5 id="图-14-说明为-LINEITEM-表创建的分区范围"><a href="#图-14-说明为-LINEITEM-表创建的分区范围" class="headerlink" title="图 14. 说明为 LINEITEM 表创建的分区范围"></a>图 14. 说明为 LINEITEM 表创建的分区范围</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MxOS5qcGc?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：在本例中，每一个分区被放置在一个不同的 TableSpID 中，这个 TableSpID 和创建表的 DDL 中指定的表空间是相对应的。</p>
</li>
<li><p>创建一个具有四个数据分区的 LINEITEM 表，每一个数据分区被显式地放在表空间并且索引被放在表空间 DMS_I1 中。 在这一步中，将引入命名分区的概念，而不是使用默认的生成名称。 首先，使用下面的命令删除现有的 LINEITEM 分区表：</p>
<h5 id="清单-32-删除表"><a href="#清单-32-删除表" class="headerlink" title="清单 32. 删除表"></a>清单 32. 删除表</h5><p> <code>db2 drop TABLE LINEITEM</code></p>
<p> 然后，使用以下的 DDL 创建 LINEITEM 表的新版本：</p>
<h5 id="清单-33-创建表"><a href="#清单-33-创建表" class="headerlink" title="清单 33. 创建表"></a>清单 33. 创建表</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> LINEITEM</span><br><span class="line">(l_orderkey           <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> l_partkey            <span class="type">INTEGER</span>,</span><br><span class="line"> l_suppkey            <span class="type">INTEGER</span>,</span><br><span class="line"> l_linenumber         <span class="type">INTEGER</span>,</span><br><span class="line"> l_quantity           <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line"> l_extendedprice      <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line"> l_discount           <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line"> l_tax                <span class="type">DECIMAL</span>(<span class="number">12</span>,<span class="number">2</span>),</span><br><span class="line"> l_returnflag         <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line"> l_linestatus         <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line"> l_shipdate           <span class="type">DATE</span>,</span><br><span class="line"> l_commitdate         <span class="type">DATE</span>,</span><br><span class="line"> l_receiptdate        <span class="type">DATE</span>,</span><br><span class="line"> l_shipinstruct       <span class="type">CHAR</span>(<span class="number">25</span>),</span><br><span class="line"> l_shipmode           <span class="type">CHAR</span>(<span class="number">10</span>),</span><br><span class="line"> l_comment            <span class="type">VARCHAR</span>(<span class="number">44</span>))</span><br><span class="line">INDEX <span class="keyword">IN</span> DMS_I1</span><br><span class="line"><span class="keyword">PARTITION</span> <span class="keyword">BY</span> <span class="keyword">RANGE</span>(l_shipdate)</span><br><span class="line">( PART JAN1992 STARTING <span class="string">&#x27;1/1/1992&#x27;</span>  ENDING <span class="string">&#x27;30/6/1992&#x27;</span> <span class="keyword">IN</span> DMS_D1,</span><br><span class="line">  PART JULY1992 STARTING <span class="string">&#x27;1/7/1992&#x27;</span> ENDING <span class="string">&#x27;31/12/1992&#x27;</span> <span class="keyword">IN</span> DMS_D2,</span><br><span class="line">  PART JAN <span class="number">1993</span> STARTING <span class="string">&#x27;1/1/1993&#x27;</span> ENDING <span class="string">&#x27;30/6/1993&#x27;</span> <span class="keyword">IN</span> DMS_D3,</span><br><span class="line">  PART JULY1993 STARTING <span class="string">&#x27;1/7/1993&#x27;</span> ENDING <span class="string">&#x27;31/12/1993&#x27;</span> <span class="keyword">IN</span> DMS_D4);</span><br><span class="line"><span class="number">1234567891011121314151617181920212223</span></span><br></pre></td></tr></table></figure>
<ol>
<li><p>创建表的 SQL 位于 EX2-8.sql 文件中，可使用下面的命令运行该文件：</p>
<h5 id="清单-34-运行-EX2-8"><a href="#清单-34-运行-EX2-8" class="headerlink" title="清单 34. 运行 EX2-8"></a>清单 34. 运行 EX2-8</h5><p> <code>db2 –vtf EX2-8.sql</code></p>
</li>
<li><p>在 LINEITEM 表中创建一个索引，并将它放置在表空间 DMS_I1 中。使用如下 SQL：</p>
<h5 id="清单-35-索引"><a href="#清单-35-索引" class="headerlink" title="清单 35. 索引"></a>清单 35. 索引</h5><p> <code>db2 “create index I_LINEITEM on LINEITEM(L_SHIPDATE) in DMS_I1”</code></p>
</li>
<li><p>使用下面的 SQL 检验和该表相关联的索引的位置：</p>
<h5 id="清单-36-说明"><a href="#清单-36-说明" class="headerlink" title="清单 36. 说明"></a>清单 36. 说明</h5><p> <code>db2 “select tabname, index_tbspace from syscat.tables where tabname = ‘LINEITEM’”</code></p>
<h5 id="图-15-检验索引的位置"><a href="#图-15-检验索引的位置" class="headerlink" title="图 15. 检验索引的位置"></a>图 15. 检验索引的位置</h5><p> <img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyMS5qcGc?x-oss-process=image/format,png" alt="命令窗口"></p>
</li>
<li><p><strong>注意</strong>：索引空间是 DMS_I1。如果没有为分区表指定表空间，那么默认情况下索引位于连接着的第一个表空间。 在 CREATE TABLE 中定义表空间是很好的实践。然而，无论您是否在创建表语句 ID 中指定索引表空间，这并不限制您将来放置索引的位置。您可以在 CREATE INDEX 语句本身显式地指定索引表空间。 同一分区表的不同索引可以放置在不同的表空间。</p>
</li>
</ol>
<h2 id="管理分区表"><a href="#管理分区表" class="headerlink" title="管理分区表"></a>管理分区表</h2><p>这个实验将查看如何管理和操作分区表：</p>
<ol>
<li>您将添加和删除分区。</li>
<li>您将执行对分区的转入转出操作。</li>
<li>在执行查看操作时将使用 DB2 命令和 SQL。</li>
</ol>
<h4 id="使用现有的表添加一个新的分区"><a href="#使用现有的表添加一个新的分区" class="headerlink" title="使用现有的表添加一个新的分区"></a>使用现有的表添加一个新的分区</h4><ol>
<li><p>将数据导入 LINEITEM 表。创建表空间的 SQL 位于 EX3-1.sql 文件中，可使用下面的命令运行该文件：</p>
<h5 id="清单-37-导入数据"><a href="#清单-37-导入数据" class="headerlink" title="清单 37. 导入数据"></a>清单 37. 导入数据</h5><p> <code>db2 –vtf EX3-1.sql</code></p>
<h5 id="图-16-将数据导入到-LINEITEM-表"><a href="#图-16-将数据导入到-LINEITEM-表" class="headerlink" title="图 16. 将数据导入到 LINEITEM 表"></a>图 16. 将数据导入到 LINEITEM 表</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyMmEuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：分区表中的记录数，以及将进行连接和分离的记录数对于说明数据库中的数据何时可用非常重要。</p>
</li>
<li><p>创建一个名为 NP_LINEITEM 的新表。脚本 EX3-2.sql 创建一个具有 87 行的新表 NP_LINEITEM:</p>
<h5 id="清单-38-新分区"><a href="#清单-38-新分区" class="headerlink" title="清单 38. 新分区"></a>清单 38. 新分区</h5><p> <code>db2 –vtf EX3-2.sql</code></p>
<h5 id="图-17-将数据导入到-NP-LINEITEM-表"><a href="#图-17-将数据导入到-NP-LINEITEM-表" class="headerlink" title="图 17. 将数据导入到 NP_LINEITEM 表"></a>图 17. 将数据导入到 NP_LINEITEM 表</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyMmIuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<p>使用下面的命令说明为 LINEITEM 表创建的分区范围：</p>
<h5 id="清单-39-说明"><a href="#清单-39-说明" class="headerlink" title="清单 39. 说明"></a>清单 39. 说明</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db2 describe data partitions for table LINEITEM show detail</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h5 id="图-18-LINEITEM-表的分区"><a href="#图-18-LINEITEM-表的分区" class="headerlink" title="图 18. LINEITEM 表的分区"></a>图 18. LINEITEM 表的分区</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyM2EuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：LINEITEM 表目前包含 4 个数据分区。</p>
</li>
<li><p>使用<code>Alter</code>语句将一个新的分区连接（转入）到现有的 LINEITEM 表。</p>
<h5 id="清单-40-新分区"><a href="#清单-40-新分区" class="headerlink" title="清单 40. 新分区"></a>清单 40. 新分区</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> LINEITEM ATTACH <span class="keyword">PARTITION</span> JAN1994 </span><br><span class="line">STARTING <span class="string">&#x27;1/1/1994&#x27;</span> ENDING <span class="string">&#x27;30/6/1994&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> NP_LINEITEM</span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure>
<p>可以使用以下命令运行脚本 EX3-4：</p>
<h5 id="清单-41-新分区"><a href="#清单-41-新分区" class="headerlink" title="清单 41. 新分区"></a>清单 41. 新分区</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db2 –vtf EX3-4.sql</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h5 id="图-19-脚本-EX3-4"><a href="#图-19-脚本-EX3-4" class="headerlink" title="图 19. 脚本 EX3-4"></a>图 19. 脚本 EX3-4</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyM2IuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：LINEITEM 表被置于 SET INTEGRITY PENDING 状态。</p>
</li>
<li><p>连接后，使用</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">describe data partitions</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p> 命令来说明为 LINEITEM 表创建的分区范围：</p>
<h5 id="清单-42-说明"><a href="#清单-42-说明" class="headerlink" title="清单 42. 说明"></a>清单 42. 说明</h5><p> <code>db2 describe data partitions for table LINEITEM show detail</code></p>
<h5 id="图-20-LINEITEM-表的分区"><a href="#图-20-LINEITEM-表的分区" class="headerlink" title="图 20. LINEITEM 表的分区"></a>图 20. LINEITEM 表的分区</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyNC5qcGc?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p>注意</p>
<p> ：新数据分区（JAN1994）PartitionId 4 现在连接到了 LINEITEM 表。然而连接的分区的 AccessMode 值为 ‘N’ 并且 Status 的值为 ‘A’。 AccessMode 可能的值有：</p>
<ul>
<li><p>D = 没有数据移动</p>
</li>
<li><p>F = 完全访问</p>
</li>
<li><p>N = 不访问</p>
</li>
<li><p>R = 只读访问</p>
<p>Status 可能的值有：</p>
</li>
<li><p>A = 数据分区是新连接的</p>
</li>
<li><p>D = 数据分区是分离的</p>
</li>
<li><p>I = 只有在执行异步索引清除时才对条目位于目录的分离的数据分区进行维护；当所有引用分离数据分区的索引记录删除后，将删除 STATUS 值为 ‘I’ 的行。</p>
</li>
<li><p>Empty string = 数据分区是可见的（普通状态）</p>
</li>
</ul>
</li>
<li><p>运行两个<code>select count</code>语句来检查连接语句涉及的两个表中数据的可用性。</p>
<h5 id="清单-43-Count-Lineitem"><a href="#清单-43-Count-Lineitem" class="headerlink" title="清单 43. Count Lineitem"></a>清单 43. Count Lineitem</h5><p> <code>db2 “select count(*) from lineitem”</code></p>
<h5 id="图-21-select-count-语句的结果"><a href="#图-21-select-count-语句的结果" class="headerlink" title="图 21. select count 语句的结果"></a>图 21. select count 语句的结果</h5></li>
</ol>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-fHcMiLd2-1576419249173)(<a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/education/data/dm0612read/s25a.jpg)]">https://www.ibm.com/developerworks/cn/education/data/dm0612read/s25a.jpg)]</a></p>
<p><strong>注意</strong>：LINEITEM 表最初的分区是可用的，但是 PartitionId 4 中的新数据仍不可见。</p>
<h5 id="清单-44-Count-np-lineitem"><a href="#清单-44-Count-np-lineitem" class="headerlink" title="清单 44. Count np-lineitem"></a>清单 44. Count np-lineitem</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db2 “select count(*) from np_lineitem”</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h5 id="图-22-select-count-语句的结果"><a href="#图-22-select-count-语句的结果" class="headerlink" title="图 22. select count 语句的结果"></a>图 22. select count 语句的结果</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyNWIuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：NP_LINEITEM 表现在是一个未定义的对象，在 LINEITEM 表内只能将其作为一个分区使用。</p>
</li>
<li><p>创建一个异常表并与 SET INTEGRITY 语句结合使用。执行该操作的 DDL 位于 EX3-7.sql 文件，可使用下面的命令运行该文件：</p>
<h5 id="清单-45-异常表"><a href="#清单-45-异常表" class="headerlink" title="清单 45. 异常表"></a>清单 45. 异常表</h5><p> <code>db2 –vtf EX3-7.sql</code></p>
</li>
<li><p>对 LINEITEM 分区表运行<code>set integrity</code>语句 。</p>
<h5 id="清单-46-设置完整性"><a href="#清单-46-设置完整性" class="headerlink" title="清单 46. 设置完整性"></a>清单 46. 设置完整性</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> INTEGRITY <span class="keyword">FOR</span> LINEITEM <span class="operator">&lt;</span>br<span class="operator">&gt;</span></span><br><span class="line">ALLOW WRITE ACCESS <span class="operator">&lt;</span>br<span class="operator">&gt;</span></span><br><span class="line">IMMEDIATE CHECKED  <span class="operator">&lt;</span>br<span class="operator">&gt;</span></span><br><span class="line"><span class="keyword">FOR</span> EXCEPTION <span class="keyword">IN</span> LINEITEM USE LINEITEM_EX</span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>
<p>执行该操作的 SQL 位于 EX3-8.sql 文件中，可以使用下面的命令运行该文件：</p>
<h5 id="清单-47-设置完整性"><a href="#清单-47-设置完整性" class="headerlink" title="清单 47. 设置完整性"></a>清单 47. 设置完整性</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db2 –vtf EX3-8.sql</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h5 id="图-23-EX3-8-sql-文件"><a href="#图-23-EX3-8-sql-文件" class="headerlink" title="图 23. EX3-8.sql 文件"></a>图 23. EX3-8.sql 文件</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyNmEuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：<code>SET INTEGRITY</code> 对于检查新连接的数据是否在范围内是必需的，它还执行对索引和其他独立对象（例如物化查询表）所有必需的维护工作。只有得到 <code>SET INTEGRITY</code> 语句的允许，新的数据才能变为可见。然而，当运行 <code>SET INTEGRITY</code> 时，可以对 LINEITEM 表中的现有数据进行完全访问，包括读和写操作。 用户应该执行 <code>SET INTEGRITY</code> 事务从而能够使用整个表。当运行 <code>SET INTEGRITY</code> 时，不能够对表执行 DDL 或其他实用类型的操作。 在这个练习中，在 NP_LINEITEM 表中创建并被连接到 LINEITEM 表的所有的行，都在连接语句指定的范围内。如果这些行中存在超出此范围的行，则需要在 <code>SET INTEGRITY</code> 语句中创建一个异常表来防止语句发生错误。所以推荐您始终在 <code>SET INTEGRITY</code> 语句中包含一个异常表。如果没有提供异常表的话，<code>SET INTEGRITY</code> 语句发现的错误将导致语句失败并且所有的工作都必须从头做起。如果使用大量数据时，这可能是一个长期操作。有一点值得注意，如果 <code>SET INTEGRITY</code> 操作失败，所有工作都需要重做，与之相比较，<code>LOAD</code> 仅仅抛弃存在问题的行。</p>
</li>
<li><p>对 LINEITEM 表运行<code>select count</code>SQL 以检查连接的分区中数据的可用性：</p>
<h5 id="清单-48-Count-Lineitem"><a href="#清单-48-Count-Lineitem" class="headerlink" title="清单 48. Count Lineitem"></a>清单 48. Count Lineitem</h5><p> <code>db2 “select count(*) from lineitem”</code></p>
<h5 id="图-24-select-count-语句的结果"><a href="#图-24-select-count-语句的结果" class="headerlink" title="图 24. select count 语句的结果"></a>图 24. select count 语句的结果</h5></li>
</ol>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-ReUztOvx-1576419249176)(<a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/education/data/dm0612read/s26b.jpg)]">https://www.ibm.com/developerworks/cn/education/data/dm0612read/s26b.jpg)]</a></p>
<ol>
<li><strong>注意</strong>：成功执行 <code>SET INTEGRITY</code> 操作后，LINEITEM 表应包含 PartitionId 4 的数据。</li>
</ol>
<h4 id="从分区表中分离一个分区"><a href="#从分区表中分离一个分区" class="headerlink" title="从分区表中分离一个分区"></a>从分区表中分离一个分区</h4><ol>
<li><p>使用<code>describe data partitions show detail</code><br> 命令来标识一个分区的 PartitionName，您将把这个分区从 LINEITEM 分区表中分离（转出）出来。</p>
<h5 id="清单-49-说明表"><a href="#清单-49-说明表" class="headerlink" title="清单 49. 说明表"></a>清单 49. 说明表</h5><p> <code>db2 describe data partitions for table LINEITEM show detail</code></p>
<h5 id="图-25-LINEITEM-表的分区"><a href="#图-25-LINEITEM-表的分区" class="headerlink" title="图 25. LINEITEM 表的分区"></a>图 25. LINEITEM 表的分区</h5></li>
</ol>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyN2EuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：将分离最早的分区范围 PartitionId 0。该分区的 PartitionName 是 JAN1992。将在 <code>DETACH</code> 操作中使用它来标识被转出的分区。同样还需注意成功执行了 <code>SET INTEGRITY</code> 操作后，分区 JAN1994 的 AccessMode 的值为 ‘F’，Status 值为空。TableSpId、PartObjId 和 LongTblSpId 的结果可能和这里显示的不一样。</p>
</li>
<li><p>使用</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Alter</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<p> 语句将 JAN1992 从 LINEITEM 表中分离（转出）。</p>
<h5 id="清单-50-Alter-表"><a href="#清单-50-Alter-表" class="headerlink" title="清单 50. Alter 表"></a>清单 50. Alter 表</h5><p> <code>ALTER TABLE LINEITEM DETACH PARTITION JAN1992 INTO LINEITEM_JAN1992</code></p>
<p> 创建文件的 SQL 位于 EX3-11.sql 文件中，可使用下面的命令运行该文件：</p>
<h5 id="清单-51-Alter-表"><a href="#清单-51-Alter-表" class="headerlink" title="清单 51. Alter 表"></a>清单 51. Alter 表</h5><p> <code>db2 –vtf EX3-11.sql.</code></p>
<p> 注意：将 JAN1992 成功分离后，将创建一个新的表 LINEITEM_JAN1992。在<code>DETACH</code>操作中没有涉及数据移动，并且位于相同表空间的新表的行为和它作为 LINEITEM 分区表的一部分时是一样的。此时不需要对 LINEITEM 表运行<code>SET INTEGRITY</code>语句，因为没有对 LINEITEM 表定义的 MQTs。 还有一点值得注意，如果从 Multi-Dimensional Clustering（MDC）分离一个分区从而创建了一个新表时，这个表也将是一个 MDC。这个规则同样适用于下面这个情况：从一个分布式表中分离分区从而在相同的分区组创建分布式表。执行<code>DETACH</code>操作后产生的表使用 MDC 索引定义而不是其他的索引。对于 MDC，在首次访问连接的表时将重新构建索引。在这种情况下，将自动对分离的分区进行索引清除操作。将从执行<code>DETACH</code>操作的用户 ID 继承索引的模式、权限和表空间。</p>
</li>
<li><p>运行两个<code>select count</code>语句检查<code>DETACH</code>语句涉及的两个表中的数据的可用性。</p>
<h5 id="清单-52-Count-Lineitem-jan1992"><a href="#清单-52-Count-Lineitem-jan1992" class="headerlink" title="清单 52. Count Lineitem_jan1992"></a>清单 52. Count Lineitem_jan1992</h5><p> <code>db2 “select count(*) from lineitem_jan1992”</code></p>
<h5 id="图-26-select-count-语句的结果"><a href="#图-26-select-count-语句的结果" class="headerlink" title="图 26. select count 语句的结果"></a>图 26. select count 语句的结果</h5></li>
</ol>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-EgIPyQFS-1576419249177)(<a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/education/data/dm0612read/s28a.jpg)]">https://www.ibm.com/developerworks/cn/education/data/dm0612read/s28a.jpg)]</a></p>
<p><strong>注意</strong>：创建的 LINEITEM_JAN1992 表包含 38 行，它被包含在 LINEITEM 分区表的 JAN1992 分区中。</p>
<h5 id="清单-53-Count-lineitem"><a href="#清单-53-Count-lineitem" class="headerlink" title="清单 53. Count lineitem"></a>清单 53. Count lineitem</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db2 “select count(*) from lineitem”</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h5 id="图-27-select-count-语句的结果"><a href="#图-27-select-count-语句的结果" class="headerlink" title="图 27. select count 语句的结果"></a>图 27. select count 语句的结果</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyOGIuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><p><strong>注意</strong>：此时 LINEITEM 表完全可用，并且不包括 PART0 中的数据。</p>
</li>
<li><p>当数据被移动到分区表中，或当希望将数据加载到或直接插入分区表中时，一个更合适的方法是向现有的分区表添加一个空的分区。使用下面的命令向现有的 LINEITEM 表添加一个空的分区：</p>
<h5 id="清单-54-说明"><a href="#清单-54-说明" class="headerlink" title="清单 54. 说明"></a>清单 54. 说明</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">db2 “<span class="keyword">ALTER</span> <span class="keyword">TABLE</span> LINEITEM <span class="keyword">ADD</span> <span class="keyword">PARTITION</span> JULY1994 </span><br><span class="line">STARTING <span class="string">&#x27;1/7/1994&#x27;</span> ENDING <span class="string">&#x27;31/12/1994&#x27;</span>”</span><br><span class="line"><span class="number">12</span></span><br></pre></td></tr></table></figure>
<h5 id="图-28-向现有的-LINEITEM-表添加一个空的分区"><a href="#图-28-向现有的-LINEITEM-表添加一个空的分区" class="headerlink" title="图 28. 向现有的 LINEITEM 表添加一个空的分区"></a>图 28. 向现有的 LINEITEM 表添加一个空的分区</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyOGMuanBn?x-oss-process=image/format,png" alt="命令窗口"></p>
<p>使用 <code>describe data partitions show detail</code> 命令来检验 PartitionName 为 JULY1994 的分区是否被添加到 LINEITEM 中：</p>
<h5 id="清单-55-说明"><a href="#清单-55-说明" class="headerlink" title="清单 55. 说明"></a>清单 55. 说明</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db2 describe data partitions for table LINEITEM show detail</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h5 id="图-29-LINEITEM-表的分区"><a href="#图-29-LINEITEM-表的分区" class="headerlink" title="图 29. LINEITEM 表的分区"></a>图 29. LINEITEM 表的分区</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MyOS5qcGc?x-oss-process=image/format,png" alt="命令窗口"></p>
<h2 id="分区表的访问计划"><a href="#分区表的访问计划" class="headerlink" title="分区表的访问计划"></a>分区表的访问计划</h2><p>本实验将研究如何在访问计划中描述分区表：</p>
<ol>
<li><p>您将更新分区表中的统计信息。</p>
</li>
<li><p>您将使用 <code>db2expln</code> 命令并分析结果。</p>
</li>
<li><p>您将在执行查看的操作中使用 DB2 命令和 SQL 。</p>
</li>
<li><p>对 LINEITEM 表执行<code>RUNSTATS</code>操作：</p>
<h5 id="清单-56-Runstats"><a href="#清单-56-Runstats" class="headerlink" title="清单 56. Runstats"></a>清单 56. Runstats</h5><p> <code>db2 runstats on table db2inst1.lineitem</code></p>
</li>
<li><p>说明以下 SQL 语句并检查说明输出：</p>
<h5 id="清单-57-说明"><a href="#清单-57-说明" class="headerlink" title="清单 57. 说明"></a>清单 57. 说明</h5><p> <code>db2 “select l_shipdate,sum(l_quantity) from LINEITEM group by l_shipdate”</code></p>
<p> 要进行说明的 SQL 位于 EX4-2.sql 文件，可以使用下面的命令运行该文件：</p>
<h5 id="清单-58-说明输出"><a href="#清单-58-说明输出" class="headerlink" title="清单 58. 说明输出"></a>清单 58. 说明输出</h5><p> <code>db2expln –d SAMPLE –t –f EX4-2.sql</code></p>
<h5 id="图-30-说明输出"><a href="#图-30-说明输出" class="headerlink" title="图 30. 说明输出"></a>图 30. 说明输出</h5></li>
</ol>
<p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-0PqTV96B-1576419249179)(<a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/education/data/dm0612read/s30.jpg)]">https://www.ibm.com/developerworks/cn/education/data/dm0612read/s30.jpg)]</a></p>
<ol>
<li><p><strong>注意</strong>：该 SQL 执行了 LINEITEM 表的索引扫描。说明输出中有一个关于表分区的要点需要注意，所访问的表是被分区的，并且在扫描过程中所有数据分区都将被访问。</p>
</li>
<li><p>说明下面的 SQL 语句并检查说明输出：</p>
<h5 id="清单-59-说明"><a href="#清单-59-说明" class="headerlink" title="清单 59. 说明"></a>清单 59. 说明</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">db2 “<span class="keyword">select</span> l_shipdate, l_partkey, l_returnflag</span><br><span class="line"><span class="keyword">from</span> LINEITEM</span><br><span class="line"><span class="keyword">where</span> l_shipdate <span class="keyword">between</span> <span class="string">&#x27;01/01/1993&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;31/08/1993&#x27;</span></span><br><span class="line"><span class="keyword">and</span> l_partkey <span class="operator">=</span> <span class="number">49981</span>”</span><br><span class="line"><span class="number">1234</span></span><br></pre></td></tr></table></figure>
<p>要进行说明的 SQL 语句位于 EX4-3.sql 文件中，可使用下面的命令运行该文件：</p>
<h5 id="清单-60-说明输出"><a href="#清单-60-说明输出" class="headerlink" title="清单 60. 说明输出"></a>清单 60. 说明输出</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">db2expln –d SAMPLE –t –f EX4-3.sql</span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h5 id="图-31-说明输出"><a href="#图-31-说明输出" class="headerlink" title="图 31. 说明输出"></a>图 31. 说明输出</h5><p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-8wvYnGp1-1576419249180)(<a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/education/data/dm0612read/s31.jpg)]">https://www.ibm.com/developerworks/cn/education/data/dm0612read/s31.jpg)]</a></p>
<ol>
<li><p><strong>注意</strong>：这个 SQL 语句执行了 LINEITEM 表的索引扫描。在本例中，可以看到优化器能够执行数据分区排除操作。在说明输出中要注意的是关于表分区，访问的表是被分区的，将执行分区排除功能以及删除活动数据分区的值。 在本例中，活动的数据分区为 1-2。这里引用的是 syscat.datapartitions 中的序列号（seqno）而不是 <code>describe data partitions</code> 命令中的 PartitionId。</p>
</li>
<li><p>使用下面的 SQL 确定在前面说明示例中活动的分区的名称：</p>
<h5 id="清单-61-说明"><a href="#清单-61-说明" class="headerlink" title="清单 61. 说明"></a>清单 61. 说明</h5></li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">db2 “<span class="keyword">select</span> seqno,datapartitionname</span><br><span class="line"><span class="keyword">from</span> syscat.datapartitions</span><br><span class="line"><span class="keyword">where</span> tabname <span class="operator">=</span> ‘LINEITEM’ <span class="keyword">order</span> <span class="keyword">by</span> seqno”</span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure>
<h5 id="图-32-分区名称"><a href="#图-32-分区名称" class="headerlink" title="图 32. 分区名称"></a>图 32. 分区名称</h5><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly93d3cuaWJtLmNvbS9kZXZlbG9wZXJ3b3Jrcy9jbi9lZHVjYXRpb24vZGF0YS9kbTA2MTJyZWFkL3MzMi5qcGc?x-oss-process=image/format,png" alt="命令窗口"></p>
<ol>
<li><strong>注意</strong>：序列号 1 和 2 分别映射的是 JAN1993 和 JULY1993 分区名称。</li>
</ol>
<h2 id="结束语"><a href="#结束语" class="headerlink" title="结束语"></a>结束语</h2><p>本教程基于 IBM DB2 9 Data Partitioning 特性。您已在以下几个方面获得了第一手的经验：</p>
<ul>
<li>如何定义分区表</li>
<li>如何将分区表放置在底层磁盘子系统</li>
<li>如何维护分区表</li>
<li>如何使用 DB2 Explain 说明分区表</li>
</ul>
<p>范围分区将数据映射到基于关键值范围的分区，用户为每一个分区建立关键值范围。例如，企业通常希望以月份为单位，将销售数据划分到各月的分区中。与 MDC 功能集合使用时，范围分区将更加方便地定位数据，从而加快通过复杂查询检索信息的速度。</p>
<h4 id="下载资源"><a href="#下载资源" class="headerlink" title="下载资源"></a>下载资源</h4><p><a target="_blank" rel="noopener" href="http://www.ibm.com/developerworks/apps/download/index.jsp?contentid=265244&filename=exfiles.zip&method=http&locale=zh_CN">本文的示例脚本和数据</a> (exfiles.zip | 60KB)<br>链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1cDtoMvkfUQZ_tmhHrcrocA">https://pan.baidu.com/s/1cDtoMvkfUQZ_tmhHrcrocA</a><br>提取码：7zev</p>
<h4 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h4><p><a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/education/data/dm0612read/dm0612read.html?from=singlemessage&amp;isappinstalled=0#ibm-pcon">https://www.ibm.com/developerworks/cn/education/data/dm0612read/dm0612read.html?from=singlemessage&amp;isappinstalled=0#ibm-pcon</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/15/shell%E7%94%9F%E6%88%90%E6%8C%87%E5%AE%9A%E9%95%BF%E5%BA%A6%E9%9A%8F%E6%9C%BA%E6%95%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/00-00-00.JPG">
      <meta itemprop="name" content="severus">
      <meta itemprop="description" content="正在享受无法回避的痛苦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sary.severus`s blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/15/shell%E7%94%9F%E6%88%90%E6%8C%87%E5%AE%9A%E9%95%BF%E5%BA%A6%E9%9A%8F%E6%9C%BA%E6%95%B0/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-15 14:28:30" itemprop="dateCreated datePublished" datetime="2021-01-15T14:28:30+08:00">2021-01-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="shell生成指定长度随机数"><a href="#shell生成指定长度随机数" class="headerlink" title="shell生成指定长度随机数"></a>shell生成指定长度随机数</h1><p>例：生成8位随机数</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tr -<span class="built_in">cd</span> <span class="string">&#x27;0-9&#x27;</span> &lt;/dev/urandom | head -c 8 </span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/15/sed%E7%94%A8%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/00-00-00.JPG">
      <meta itemprop="name" content="severus">
      <meta itemprop="description" content="正在享受无法回避的痛苦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sary.severus`s blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/15/sed%E7%94%A8%E6%B3%95/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-15 14:28:30" itemprop="dateCreated datePublished" datetime="2021-01-15T14:28:30+08:00">2021-01-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>sed 是一种在线的非交互的编译器，它一次处理一行的内容。处理时，把当前处理的行储存在临时缓冲区中，称为模式空间，接着用sed命令处理缓冲区的内容，处理完成后，把缓冲区的内容送往屏幕。接着处理下一行，这样不断重复，直到文件末尾。文件内容并没有改变，除非你使用重定向储存输出。<br> sed主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。</p>
<h3 id="用法-sed-命令-＋目录-文件1-目录-文件2"><a href="#用法-sed-命令-＋目录-文件1-目录-文件2" class="headerlink" title="用法 sed + 命令  ＋目录/文件1  目录/文件2"></a>用法 sed + 命令  ＋目录/文件1  目录/文件2</h3><h5 id="sed支持正则表达式"><a href="#sed支持正则表达式" class="headerlink" title="sed支持正则表达式"></a>sed支持正则表达式</h5><p>使用基本元字符集 ^, $, ., *, [], [^], &lt; &gt;,(),{}<br> 使用扩展元字符集 ?, +, { }, |, ( )使用扩展元字符的方式：<br> sed -r</p>
<h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -r <span class="string">&#x27; &#x27;</span>      mypasswd</span><br><span class="line">sed -r <span class="string">&#x27; p &#x27;</span>   mypasswd</span><br></pre></td></tr></table></figure>
<p>屏蔽默认输出使用 -n选项</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -rn <span class="string">&#x27; p &#x27;</span>   mypasswd</span><br><span class="line">sed -rn  <span class="string">&#x27; /root/p &#x27;</span>  mypasswd  显示root的行    ^匹配root开头   ^root</span><br></pre></td></tr></table></figure>
<h1 id="探索替换-（重要）"><a href="#探索替换-（重要）" class="headerlink" title="探索替换*（重要）"></a>探索替换*（重要）</h1><p>sed会自动打印文件的每一行， 查找模式匹配的行，找到后执行后面的命令，默认是输出（不加-n）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sed -r <span class="string">&#x27; s/root/shark/ &#x27;</span>  mypasswd</span><br><span class="line">搜索每一行，找到有root的，只替换第一个</span><br><span class="line">sed -r <span class="string">&#x27; s/root/shark/g &#x27;</span>  mypasswd</span><br><span class="line">搜索每一行，找到有root的进行全局替换</span><br><span class="line">sed -r <span class="string">&#x27; s/root/shark/gi &#x27;</span>   mypasswd</span><br><span class="line">i  同时忽略大小写</span><br><span class="line">sed -r <span class="string">&#x27;  /root/d &#x27;</span> mypasswd</span><br><span class="line">找到含有root的进行删除</span><br></pre></td></tr></table></figure>
<h3 id="删除命令拓展"><a href="#删除命令拓展" class="headerlink" title="删除命令拓展"></a>删除命令拓展</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">sed -r <span class="string">&#x27;d&#x27;</span>  mypasswd</span><br><span class="line">全部分删除</span><br><span class="line">sed -r  <span class="string">&#x27; 3   d &#x27;</span></span><br><span class="line">删除第三行</span><br><span class="line">sed -r  <span class="string">&#x27; 1,3 d &#x27;</span> </span><br><span class="line">第一行到第三行都删除</span><br><span class="line">sed -r <span class="string">&#x27; /root/ d &#x27;</span></span><br><span class="line">含有root的字符串删除</span><br><span class="line">sed -r <span class="string">&#x27; /root/,5 d &#x27;</span></span><br><span class="line">从含有root字符串的行开始，一直到第5行进行删除</span><br><span class="line">sed -r <span class="string">&#x27; /^adm/，20 d &#x27;</span></span><br><span class="line">从行首是adm 的行开始，一直到20行进行删除</span><br><span class="line">sed -r <span class="string">&#x27; /^adm/ ,+2 d &#x27;</span> </span><br><span class="line">从行首是adm的行，以及此后两行的进行删除</span><br><span class="line">sed -r <span class="string">&#x27; /root/ !d &#x27;</span></span><br><span class="line">含有root的行不删除，其他都删除</span><br><span class="line">sed -r <span class="string">&#x27; 1~2 d &#x27;</span></span><br><span class="line">奇数行删除，其实就是匹配到行号除以2，余数是1的行</span><br><span class="line">sed -rn <span class="string">&#x27; 0~2  p &#x27;</span></span><br><span class="line">偶数行打印</span><br></pre></td></tr></table></figure>
<h2 id="sed参数大全"><a href="#sed参数大全" class="headerlink" title="sed参数大全"></a>sed参数大全</h2><p>a 在当前行后添加一行或多行<br> c 用新文本修改（替换）当前行中的文本<br> d 删除行<br> i 在当前行之前插入文本<br> l 列出非打印字符<br> p 打印行<br> n 读入下一输入行，并从下一条命令而不是第一条命令开始对其的处理<br> q 结束或退出sed<br> ! 对所选行以外的所有行应用命令</p>
<p>s 用一个字符串替换另一个<br> s 替换标志<br> g 全局替换<br> i 忽略大小写<br> r 从文件中读<br> w 将行写入文件<br> y 将字符转换为另一字符（不支持正则表达式）</p>
<p>h  清除保持空间的内容后，把模式空间里的内容复制到保持空间<br> H  把模式空间里的内容追加到保持空间<br> g  清除模式空间的内容后， 取出保持空间的内容，并复制到模式空间<br> G  取出保持空间的内容，追加在模式空间原有内容的后面<br> x  交换模式空间与保持空间的内容</p>
<p>作者：linux_python<br>链接：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/9f48cb974f1e">https://www.jianshu.com/p/9f48cb974f1e</a><br>来源：简书<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/15/maven%E6%89%8B%E5%8A%A8%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96Jar%E5%8C%85%E5%88%B0%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/00-00-00.JPG">
      <meta itemprop="name" content="severus">
      <meta itemprop="description" content="正在享受无法回避的痛苦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sary.severus`s blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/15/maven%E6%89%8B%E5%8A%A8%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96Jar%E5%8C%85%E5%88%B0%E6%9C%AC%E5%9C%B0%E4%BB%93%E5%BA%93/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-15 14:28:30" itemprop="dateCreated datePublished" datetime="2021-01-15T14:28:30+08:00">2021-01-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="报错"><a href="#报错" class="headerlink" title="报错"></a>报错</h2><p>[INFO] ————————————————————————<br>[INFO] Reactor Summary:<br>[INFO]<br>[INFO] deposit-dal 1.0.0 ……………………………. SUCCESS [01:32 min]<br>[INFO] deposit 1.0.0 ……………………………….. SUCCESS [  0.008 s]<br>[INFO] deposit-common 1.0.0 …………………………. FAILURE [  2.412 s]<br>[INFO] deposit-api 1.0.0 ……………………………. SKIPPED<br>[INFO] timer-web 1.3.1 ……………………………… SKIPPED<br>[INFO] timer-service 1.3.1 ………………………….. SKIPPED<br>[INFO] ————————————————————————<br>[INFO] BUILD FAILURE<br>[INFO] ————————————————————————<br>[INFO] Total time:  01:35 min<br>[INFO] Finished at: 2020-03-25T12:06:52+08:00<br>[INFO] ————————————————————————<br>[ERROR] Failed to execute goal on project deposit-common: Could not resolve dependencies for project org.com.yz:deposit-common:jar:1.0.0: The following artifacts could not be resolved: org.apache.gnete:gnete-bc:jar:138, org.apache.gnete:gnete-security:jar:1.1: Could not find artifact org.apache.gnete:gnete-bc:jar:138 in central (<a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2">https://repo.maven.apache.org/maven2</a>) -&gt; [Help 1]<br>[ERROR]<br>[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.<br>[ERROR] Re-run Maven using the -X switch to enable full debug logging.<br>[ERROR]<br>[ERROR] For more information about the errors and possible solutions, please read the following articles:<br>[ERROR] [Help 1] <a target="_blank" rel="noopener" href="http://cwiki.apache.org/confluence/display/MAVEN/DependencyResolutionException">http://cwiki.apache.org/confluence/display/MAVEN/DependencyResolutionException</a><br>[ERROR]<br>[ERROR] After correcting the problems, you can resume the build with the command<br>[ERROR]   mvn <args> -rf :deposit-common</p>
<p>通过第一个未成功的项目着手，进入deposit-common目录中，vim该目录下的pom.xml文件，搜索gnete-bc:jar:138中的关键字，如搜索bc<br>找到了pom中的依赖项：<br><dependency><br>    <groupId>org.apache.gnete</groupId><br>    <artifactId>gnete-bc</artifactId><br>    <version>138</version><br></dependency></p>
<dependency>
    <groupId>org.apache.gnete</groupId>
    <artifactId>gnete-security</artifactId>
    <version>1.1</version>
</dependency>

<hr>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>找到依赖项后，找依赖jar包，将依赖jar包放到/maven/lib目录下，并在该目录进行安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mvn install:install-file \</span><br><span class="line">    -Dfile=gnete-security-1.1.jar \</span><br><span class="line">    -DgroupId=org.apache.gnete \</span><br><span class="line">    -DartifactId=gnete-security \</span><br><span class="line">    -Dversion=1.1 \</span><br><span class="line">    -Dpackaging=jar </span><br><span class="line">	</span><br><span class="line">mvn install:install-file \</span><br><span class="line">    -Dfile=gnete-bc-138.jar \</span><br><span class="line">    -DgroupId=org.apache.gnete \</span><br><span class="line">    -DartifactId=gnete-bc \</span><br><span class="line">    -Dversion=138 \</span><br><span class="line">    -Dpackaging=jar </span><br></pre></td></tr></table></figure>
<p>[root-hzyzjenkins lib]# ll<br>总用量 13632<br>-rw-r–r– 1 root root   44908 11月  7 20:32 cdi-api-1.0.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 cdi-api.license<br>-rw-r–r– 1 root root   53820 11月  7 20:32 commons-cli-1.4.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 commons-cli.license<br>-rw-r–r– 1 root root  208700 11月  7 20:32 commons-io-2.5.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 commons-io.license<br>-rw-r–r– 1 root root  501879 11月  7 20:32 commons-lang3-3.8.1.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 commons-lang3.license<br>drwxr-xr-x 2 root root    4096 3月  19 17:54 ext<br>-rwxr-xr-x 1 root root 2916373 3月  23 10:41 gnete-bc-138.jar                            &lt;——<br>-rwxr-xr-x 1 root root  277034 3月  23 10:41 gnete-security-1.1.jar                        &lt;——<br>-rw-r–r– 1 root root 2591373 11月  7 20:32 guava-25.1-android.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 guava.license<br>-rw-r–r– 1 root root  520662 11月  7 20:32 guice-4.2.1-no_aop.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 guice.license<br>-rw-r–r– 1 root root  283858 11月  7 20:32 jansi-1.17.1.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 jansi.license<br>drwxr-xr-x 9 root root    4096 3月  19 17:54 jansi-native<br>-rw-r–r– 1 root root    2497 11月  7 20:32 javax.inject-1.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 javax.inject.license<br>-rw-r–r– 1 root root   16539 11月  7 20:32 jcl-over-slf4j-1.7.29.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 jcl-over-slf4j.license<br>-rw-r–r– 1 root root  397115 11月  7 20:32 jsoup-1.12.1.jar<br>-rw-r–r– 1 root root    1192 11月  7 20:32 jsoup.license<br>-rw-r–r– 1 root root    5848 11月  7 20:32 jsr250-api-1.0.jar<br>-rw-r–r– 1 root root   20545 11月  7 20:32 jsr250-api.license<br>-rw-r–r– 1 root root   57824 11月  7 20:32 maven-artifact-3.6.3.jar<br>-rw-r–r– 1 root root   14262 11月  7 20:32 maven-builder-support-3.6.3.jar<br>-rw-r–r– 1 root root  287955 11月  7 20:32 maven-compat-3.6.3.jar<br>-rw-r–r– 1 root root  633028 11月  7 20:32 maven-core-3.6.3.jar<br>-rw-r–r– 1 root root   98096 11月  7 20:32 maven-embedder-3.6.3.jar<br>-rw-r–r– 1 root root  215412 11月  7 20:32 maven-model-3.6.3.jar<br>-rw-r–r– 1 root root  192302 11月  7 20:32 maven-model-builder-3.6.3.jar<br>-rw-r–r– 1 root root   47035 11月  7 20:32 maven-plugin-api-3.6.3.jar<br>-rw-r–r– 1 root root   27158 11月  7 20:32 maven-repository-metadata-3.6.3.jar<br>-rw-r–r– 1 root root  148983 11月  7 20:32 maven-resolver-api-1.4.1.jar<br>-rw-r–r– 1 root root   44143 11月  7 20:32 maven-resolver-connector-basic-1.4.1.jar<br>-rw-r–r– 1 root root  180696 11月  7 20:32 maven-resolver-impl-1.4.1.jar<br>-rw-r–r– 1 root root   66242 11月  7 20:32 maven-resolver-provider-3.6.3.jar<br>-rw-r–r– 1 root root   36732 11月  7 20:32 maven-resolver-spi-1.4.1.jar<br>-rw-r–r– 1 root root   31013 11月  7 20:32 maven-resolver-transport-wagon-1.4.1.jar<br>-rw-r–r– 1 root root  167529 11月  7 20:32 maven-resolver-util-1.4.1.jar<br>-rw-r–r– 1 root root   44047 11月  7 20:32 maven-settings-3.6.3.jar<br>-rw-r–r– 1 root root   42090 11月  7 20:32 maven-settings-builder-3.6.3.jar<br>-rw-r–r– 1 root root  166562 11月  7 20:32 maven-shared-utils-3.2.1.jar<br>-rw-r–r– 1 root root   23815 11月  7 20:32 maven-slf4j-provider-3.6.3.jar<br>-rw-r–r– 1 root root  379197 11月  7 20:32 org.eclipse.sisu.inject-0.3.4.jar<br>-rw-r–r– 1 root root   11530 11月  7 20:32 org.eclipse.sisu.inject.license<br>-rw-r–r– 1 root root  205323 11月  7 20:32 org.eclipse.sisu.plexus-0.3.4.jar<br>-rw-r–r– 1 root root   11530 11月  7 20:32 org.eclipse.sisu.plexus.license<br>-rw-r–r– 1 root root   13350 11月  7 20:32 plexus-cipher-1.7.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 plexus-cipher.license<br>-rw-r–r– 1 root root    4225 11月  7 20:32 plexus-component-annotations-2.1.0.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 plexus-component-annotations.license<br>-rw-r–r– 1 root root   85327 11月  7 20:32 plexus-interpolation-1.25.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 plexus-interpolation.license<br>-rw-r–r– 1 root root   27703 11月  7 20:32 plexus-sec-dispatcher-1.4.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 plexus-sec-dispatcher.license<br>-rw-r–r– 1 root root  261801 11月  7 20:32 plexus-utils-3.2.1.jar<br>-rw-r–r– 1 root root   11560 11月  7 20:32 plexus-utils.license<br>-rw-r–r– 1 root root   41424 11月  7 20:32 slf4j-api-1.7.29.jar<br>-rw-r–r– 1 root root    1224 11月  7 20:32 slf4j-api.license<br>-rw-r–r– 1 root root   11586 11月  7 20:32 wagon-file-3.3.4.jar<br>-rw-r–r– 1 root root 2206349 11月  7 20:32 wagon-http-3.3.4-shaded.jar<br>-rw-r–r– 1 root root   55776 11月  7 20:32 wagon-provider-api-3.3.4.jar<br>[root-hzyzjenkins lib]# mvn install:install-file              \</p>
<blockquote>
<pre><code>-Dfile=gnete-bc-138.jar        \
-DgroupId=org.apache.gnete    \
-DartifactId=gnete-bc          \
-Dversion=138                    \
-Dpackaging=jar </code></pre>
<p>[WARNING]<br>[WARNING] Some problems were encountered while building the effective settings<br>[WARNING] Unrecognised tag: ‘mirror’ (position: START_TAG seen …<!-- \u963f\u91cc\u4e91\u955c\u50cf-->\n        <mirror>… @138:17)  @ /maven/conf/settings.xml, line 138, column 17<br>[WARNING]<br>[INFO] Scanning for projects…<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.pom">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.pom">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.pom</a> (3.9 kB at 1.9 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-plugins/22/maven-plugins-22.pom">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-plugins/22/maven-plugins-22.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-plugins/22/maven-plugins-22.pom">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-plugins/22/maven-plugins-22.pom</a> (13 kB at 17 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.jar">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.jar</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.jar">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-clean-plugin/2.5/maven-clean-plugin-2.5.jar</a> (25 kB at 34 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-install-plugin/2.4/maven-install-plugin-2.4.pom">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-install-plugin/2.4/maven-install-plugin-2.4.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-install-plugin/2.4/maven-install-plugin-2.4.pom">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-install-plugin/2.4/maven-install-plugin-2.4.pom</a> (6.4 kB at 12 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-plugins/23/maven-plugins-23.pom">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-plugins/23/maven-plugins-23.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-plugins/23/maven-plugins-23.pom">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-plugins/23/maven-plugins-23.pom</a> (9.2 kB at 19 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-install-plugin/2.4/maven-install-plugin-2.4.jar">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-install-plugin/2.4/maven-install-plugin-2.4.jar</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-install-plugin/2.4/maven-install-plugin-2.4.jar">https://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-install-plugin/2.4/maven-install-plugin-2.4.jar</a> (27 kB at 46 kB/s)<br>[INFO]<br>[INFO] ——————&lt; org.apache.maven:standalone-pom &gt;——————-<br>[INFO] Building Maven Stub Project (No POM) 1<br>[INFO] ——————————–[ pom ]———————————<br>[INFO]<br>[INFO] — maven-install-plugin:2.4:install-file (default-cli) @ standalone-pom —<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-api/2.0.6/maven-plugin-api-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-api/2.0.6/maven-plugin-api-2.0.6.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-api/2.0.6/maven-plugin-api-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-api/2.0.6/maven-plugin-api-2.0.6.pom</a> (1.5 kB at 3.4 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven/2.0.6/maven-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven/2.0.6/maven-2.0.6.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven/2.0.6/maven-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven/2.0.6/maven-2.0.6.pom</a> (9.0 kB at 9.0 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-parent/5/maven-parent-5.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-parent/5/maven-parent-5.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-parent/5/maven-parent-5.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-parent/5/maven-parent-5.pom</a> (15 kB at 37 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-project/2.0.6/maven-project-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-project/2.0.6/maven-project-2.0.6.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-project/2.0.6/maven-project-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-project/2.0.6/maven-project-2.0.6.pom</a> (2.6 kB at 4.9 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-settings/2.0.6/maven-settings-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-settings/2.0.6/maven-settings-2.0.6.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-settings/2.0.6/maven-settings-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-settings/2.0.6/maven-settings-2.0.6.pom</a> (2.0 kB at 3.7 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-model/2.0.6/maven-model-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-model/2.0.6/maven-model-2.0.6.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-model/2.0.6/maven-model-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-model/2.0.6/maven-model-2.0.6.pom</a> (3.0 kB at 6.0 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/1.4.1/plexus-utils-1.4.1.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/1.4.1/plexus-utils-1.4.1.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/1.4.1/plexus-utils-1.4.1.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/1.4.1/plexus-utils-1.4.1.pom</a> (1.9 kB at 3.4 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-profile/2.0.6/maven-profile-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-profile/2.0.6/maven-profile-2.0.6.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-profile/2.0.6/maven-profile-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-profile/2.0.6/maven-profile-2.0.6.pom</a> (2.0 kB at 4.4 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact-manager/2.0.6/maven-artifact-manager-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact-manager/2.0.6/maven-artifact-manager-2.0.6.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact-manager/2.0.6/maven-artifact-manager-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact-manager/2.0.6/maven-artifact-manager-2.0.6.pom</a> (2.6 kB at 5.0 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-repository-metadata/2.0.6/maven-repository-metadata-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-repository-metadata/2.0.6/maven-repository-metadata-2.0.6.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-repository-metadata/2.0.6/maven-repository-metadata-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-repository-metadata/2.0.6/maven-repository-metadata-2.0.6.pom</a> (1.9 kB at 3.5 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact/2.0.6/maven-artifact-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact/2.0.6/maven-artifact-2.0.6.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact/2.0.6/maven-artifact-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact/2.0.6/maven-artifact-2.0.6.pom</a> (1.6 kB at 3.2 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-registry/2.0.6/maven-plugin-registry-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-registry/2.0.6/maven-plugin-registry-2.0.6.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-registry/2.0.6/maven-plugin-registry-2.0.6.pom">https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-registry/2.0.6/maven-plugin-registry-2.0.6.pom</a> (1.9 kB at 3.5 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/3.0.5/plexus-utils-3.0.5.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/3.0.5/plexus-utils-3.0.5.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/3.0.5/plexus-utils-3.0.5.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/3.0.5/plexus-utils-3.0.5.pom</a> (2.5 kB at 6.1 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus/3.1/plexus-3.1.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus/3.1/plexus-3.1.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus/3.1/plexus-3.1.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus/3.1/plexus-3.1.pom</a> (19 kB at 19 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-digest/1.0/plexus-digest-1.0.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-digest/1.0/plexus-digest-1.0.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-digest/1.0/plexus-digest-1.0.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-digest/1.0/plexus-digest-1.0.pom</a> (1.1 kB at 2.7 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-components/1.1.7/plexus-components-1.1.7.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-components/1.1.7/plexus-components-1.1.7.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-components/1.1.7/plexus-components-1.1.7.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-components/1.1.7/plexus-components-1.1.7.pom</a> (5.0 kB at 9.1 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus/1.0.8/plexus-1.0.8.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus/1.0.8/plexus-1.0.8.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus/1.0.8/plexus-1.0.8.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus/1.0.8/plexus-1.0.8.pom</a> (7.2 kB at 14 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-container-default/1.0-alpha-8/plexus-container-default-1.0-alpha-8.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-container-default/1.0-alpha-8/plexus-container-default-1.0-alpha-8.pom</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-container-default/1.0-alpha-8/plexus-container-default-1.0-alpha-8.pom">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-container-default/1.0-alpha-8/plexus-container-default-1.0-alpha-8.pom</a> (7.3 kB at 15 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-api/2.0.6/maven-plugin-api-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-api/2.0.6/maven-plugin-api-2.0.6.jar</a><br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-project/2.0.6/maven-project-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-project/2.0.6/maven-project-2.0.6.jar</a><br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-settings/2.0.6/maven-settings-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-settings/2.0.6/maven-settings-2.0.6.jar</a><br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-profile/2.0.6/maven-profile-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-profile/2.0.6/maven-profile-2.0.6.jar</a><br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-registry/2.0.6/maven-plugin-registry-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-registry/2.0.6/maven-plugin-registry-2.0.6.jar</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-api/2.0.6/maven-plugin-api-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-api/2.0.6/maven-plugin-api-2.0.6.jar</a> (13 kB at 23 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-model/2.0.6/maven-model-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-model/2.0.6/maven-model-2.0.6.jar</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-registry/2.0.6/maven-plugin-registry-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-plugin-registry/2.0.6/maven-plugin-registry-2.0.6.jar</a> (29 kB at 22 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact-manager/2.0.6/maven-artifact-manager-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact-manager/2.0.6/maven-artifact-manager-2.0.6.jar</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-model/2.0.6/maven-model-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-model/2.0.6/maven-model-2.0.6.jar</a> (86 kB at 48 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-repository-metadata/2.0.6/maven-repository-metadata-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-repository-metadata/2.0.6/maven-repository-metadata-2.0.6.jar</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-project/2.0.6/maven-project-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-project/2.0.6/maven-project-2.0.6.jar</a> (116 kB at 62 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact/2.0.6/maven-artifact-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact/2.0.6/maven-artifact-2.0.6.jar</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact-manager/2.0.6/maven-artifact-manager-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact-manager/2.0.6/maven-artifact-manager-2.0.6.jar</a> (57 kB at 26 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/3.0.5/plexus-utils-3.0.5.jar">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/3.0.5/plexus-utils-3.0.5.jar</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-repository-metadata/2.0.6/maven-repository-metadata-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-repository-metadata/2.0.6/maven-repository-metadata-2.0.6.jar</a> (24 kB at 11 kB/s)<br>Downloading from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-digest/1.0/plexus-digest-1.0.jar">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-digest/1.0/plexus-digest-1.0.jar</a><br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-settings/2.0.6/maven-settings-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-settings/2.0.6/maven-settings-2.0.6.jar</a> (49 kB at 22 kB/s)<br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-digest/1.0/plexus-digest-1.0.jar">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-digest/1.0/plexus-digest-1.0.jar</a> (12 kB at 4.4 kB/s)<br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact/2.0.6/maven-artifact-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-artifact/2.0.6/maven-artifact-2.0.6.jar</a> (87 kB at 30 kB/s)<br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/apache/maven/maven-profile/2.0.6/maven-profile-2.0.6.jar">https://repo.maven.apache.org/maven2/org/apache/maven/maven-profile/2.0.6/maven-profile-2.0.6.jar</a> (35 kB at 12 kB/s)<br>Downloaded from central: <a target="_blank" rel="noopener" href="https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/3.0.5/plexus-utils-3.0.5.jar">https://repo.maven.apache.org/maven2/org/codehaus/plexus/plexus-utils/3.0.5/plexus-utils-3.0.5.jar</a> (230 kB at 44 kB/s)<br>[INFO] Installing /maven/lib/gnete-bc-138.jar to /home/jenkins/repository/org/apache/gnete/gnete-bc/138/gnete-bc-138.jar<br>[INFO] Installing /tmp/mvninstall3072155994697874891.pom to /home/jenkins/repository/org/apache/gnete/gnete-bc/138/gnete-bc-138.pom<br>[INFO] ————————————————————————<br>[INFO] BUILD SUCCESS<br>[INFO] ————————————————————————<br>[INFO] Total time:  21.767 s<br>[INFO] Finished at: 2020-03-25T13:55:11+08:00<br>[INFO] ————————————————————————<br>[root-hzyzjenkins lib]#<br>[root-hzyzjenkins lib]# mvn install:install-file              <br>    -Dfile=gnete-security-1.1.jar        <br>    -DgroupId=org.apache.gnete    <br>    -DartifactId=gnete-security          <br>    -Dversion=1.1                    <br>    -Dpackaging=jar<br>[WARNING]<br>[WARNING] Some problems were encountered while building the effective settings<br>[WARNING] Unrecognised tag: ‘mirror’ (position: START_TAG seen …<!-- \u963f\u91cc\u4e91\u955c\u50cf-->\n        <mirror>… @138:17)  @ /maven/conf/settings.xml, line 138, column 17<br>[WARNING]<br>[INFO] Scanning for projects…<br>[INFO]<br>[INFO] ——————&lt; org.apache.maven:standalone-pom &gt;——————-<br>[INFO] Building Maven Stub Project (No POM) 1<br>[INFO] ——————————–[ pom ]———————————<br>[INFO]<br>[INFO] — maven-install-plugin:2.4:install-file (default-cli) @ standalone-pom —<br>[INFO] Installing /maven/lib/gnete-security-1.1.jar to /home/jenkins/repository/org/apache/gnete/gnete-security/1.1/gnete-security-1.1.jar<br>[INFO] Installing /tmp/mvninstall687871649075747491.pom to /home/jenkins/repository/org/apache/gnete/gnete-security/1.1/gnete-security-1.1.pom<br>[INFO] ————————————————————————<br>[INFO] BUILD SUCCESS<br>[INFO] ————————————————————————<br>[INFO] Total time:  0.756 s<br>[INFO] Finished at: 2020-03-25T13:56:15+08:00<br>[INFO] ————————————————————————</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/15/docker%E5%AE%B9%E5%99%A8%E5%86%85%E6%94%AF%E6%8C%81%E4%B8%AD%E6%96%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/00-00-00.JPG">
      <meta itemprop="name" content="severus">
      <meta itemprop="description" content="正在享受无法回避的痛苦">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Sary.severus`s blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/15/docker%E5%AE%B9%E5%99%A8%E5%86%85%E6%94%AF%E6%8C%81%E4%B8%AD%E6%96%87/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-01-15 14:28:30" itemprop="dateCreated datePublished" datetime="2021-01-15T14:28:30+08:00">2021-01-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="进入docker容器里发现中文不能正常显示"><a href="#进入docker容器里发现中文不能正常显示" class="headerlink" title="进入docker容器里发现中文不能正常显示"></a>进入docker容器里发现中文不能正常显示</h1><p>输入locae，发现编码是POSIX，而POSIX是不支持中文的，所以要改下字符编码，修改为</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[<span class="type">root</span>@<span class="number">69</span><span class="type">f67e4e450f</span> <span class="type">elasticsearch</span>]<span class="comment"># locale</span></span><br><span class="line">LANG=</span><br><span class="line">LC_CTYPE=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_NUMERIC=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_TIME=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_COLLATE=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_MONETARY=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_MESSAGES=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_PAPER=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_NAME=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_ADDRESS=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_TELEPHONE=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_MEASUREMENT=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_IDENTIFICATION=<span class="string">&quot;POSIX&quot;</span></span><br><span class="line">LC_ALL=</span><br><span class="line"></span><br><span class="line"><span class="number">12345678910111213141516</span></span><br></pre></td></tr></table></figure>
<p>退出容器，然后用：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">docker exec <span class="literal">-it</span> 容器id env LANG=en_US.utf8 /bin/bash</span><br><span class="line"><span class="number">1</span></span><br><span class="line">[<span class="type">root</span>@<span class="number">69</span><span class="type">f67e4e450f</span> <span class="type">elasticsearch</span>]<span class="comment"># locale</span></span><br><span class="line">LANG=en_US.utf8</span><br><span class="line">LC_CTYPE=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_NUMERIC=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_TIME=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_COLLATE=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_MONETARY=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_MESSAGES=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_PAPER=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_NAME=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_ADDRESS=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_TELEPHONE=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_MEASUREMENT=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_IDENTIFICATION=<span class="string">&quot;en_US.utf8&quot;</span></span><br><span class="line">LC_ALL=</span><br><span class="line"></span><br><span class="line"><span class="number">12345678910111213141516</span></span><br></pre></td></tr></table></figure>
<p>发现编码改了，这样中文就能正常显示了，不过 这只是临时修改的，永久修改暂时还不知道怎么改…</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="severus"
      src="/images/00-00-00.JPG">
  <p class="site-author-name" itemprop="name">severus</p>
  <div class="site-description" itemprop="description">正在享受无法回避的痛苦</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">66</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 1876 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">severus</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
